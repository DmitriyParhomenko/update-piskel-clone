!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=28)}([function(t,e,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)r(n,i)&&(t[i]=n[i])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var a={arraySet:function(t,e,n,i,r){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+i),r);else for(var a=0;a<i;a++)t[r+a]=e[n+a]},flattenChunks:function(t){var e,n,i,r,a,s;for(i=0,e=0,n=t.length;e<n;e++)i+=t[e].length;for(s=new Uint8Array(i),r=0,e=0,n=t.length;e<n;e++)a=t[e],s.set(a,r),r+=a.length;return s}},s={arraySet:function(t,e,n,i,r){for(var a=0;a<i;a++)t[r+a]=e[n+a]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,a)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(i)},function(t,e,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n=t[1]||"",i=t[3];if(!i)return n;if(e&&"function"==typeof btoa){var r=(s=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),a=i.sources.map(function(t){return"/*# sourceURL="+i.sourceRoot+t+" */"});return[n].concat(a).concat([r]).join("\n")}var s;return[n].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},r=0;r<this.length;r++){var a=this[r][0];null!=a&&(i[a]=!0)}for(r=0;r<t.length;r++){var s=t[r];null!=s[0]&&i[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),e.push(s))}},e}},function(t,e,n){var i,r,a={},s=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=i.apply(this,arguments)),r}),o=function(t){var e={};return function(t,n){if("function"==typeof t)return t();if(void 0===e[t]){var i=function(t,e){return e?e.querySelector(t):document.querySelector(t)}.call(this,t,n);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}}(),c=null,h=0,l=[],d=n(23);function u(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=a[i.id];if(r){r.refs++;for(var s=0;s<r.parts.length;s++)r.parts[s](i.parts[s]);for(;s<i.parts.length;s++)r.parts.push(_(i.parts[s],e))}else{var o=[];for(s=0;s<i.parts.length;s++)o.push(_(i.parts[s],e));a[i.id]={id:i.id,refs:1,parts:o}}}}function f(t,e){for(var n=[],i={},r=0;r<t.length;r++){var a=t[r],s=e.base?a[0]+e.base:a[0],o={css:a[1],media:a[2],sourceMap:a[3]};i[s]?i[s].parts.push(o):n.push(i[s]={id:s,parts:[o]})}return n}function p(t,e){var n=o(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=l[l.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),l.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=o(t.insertAt.before,n);n.insertBefore(e,r)}}function m(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=l.indexOf(t);e>=0&&l.splice(e,1)}function g(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var i=function(){0;return n.nc}();i&&(t.attrs.nonce=i)}return v(e,t.attrs),p(t,e),e}function v(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function _(t,e){var n,i,r,a;if(e.transform&&t.css){if(!(a="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=a}if(e.singleton){var s=h++;n=c||(c=g(e)),i=y.bind(null,n,s,!1),r=y.bind(null,n,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",v(e,t.attrs),p(t,e),e}(e),i=function(t,e,n){var i=n.css,r=n.sourceMap,a=void 0===e.convertToAbsoluteUrls&&r;(e.convertToAbsoluteUrls||a)&&(i=d(i));r&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var s=new Blob([i],{type:"text/css"}),o=t.href;t.href=URL.createObjectURL(s),o&&URL.revokeObjectURL(o)}.bind(null,n,e),r=function(){m(n),n.href&&URL.revokeObjectURL(n.href)}):(n=g(e),i=function(t,e){var n=e.css,i=e.media;i&&t.setAttribute("media",i);if(t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),r=function(){m(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=s()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=f(t,e);return u(n,e),function(t){for(var i=[],r=0;r<n.length;r++){var s=n[r];(o=a[s.id]).refs--,i.push(o)}t&&u(f(t,e),e);for(r=0;r<i.length;r++){var o;if(0===(o=i[r]).refs){for(var c=0;c<o.parts.length;c++)o.parts[c]();delete a[o.id]}}}};var b,w=(b=[],function(t,e){return b[t]=e,b.filter(Boolean).join("\n")});function y(t,e,n,i){var r=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=w(e,r);else{var a=document.createTextNode(r),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(a,s[e]):t.appendChild(a)}}},function(t,e,n){"use strict";t.exports=function(t,e,n,i){for(var r=65535&t|0,a=t>>>16&65535|0,s=0;0!==n;){n-=s=n>2e3?2e3:n;do{a=a+(r=r+e[i++]|0)|0}while(--s);r%=65521,a%=65521}return r|a<<16|0}},function(t,e,n){"use strict";var i=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();t.exports=function(t,e,n,r){var a=i,s=r+n;t^=-1;for(var o=r;o<s;o++)t=t>>>8^a[255&(t^e[o])];return-1^t}},function(t,e,n){"use strict";var i=n(0),r=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(t){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){a=!1}for(var s=new i.Buf8(256),o=0;o<256;o++)s[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function c(t,e){if(e<65534&&(t.subarray&&a||!t.subarray&&r))return String.fromCharCode.apply(null,i.shrinkBuf(t,e));for(var n="",s=0;s<e;s++)n+=String.fromCharCode(t[s]);return n}s[254]=s[254]=1,e.string2buf=function(t){var e,n,r,a,s,o=t.length,c=0;for(a=0;a<o;a++)55296==(64512&(n=t.charCodeAt(a)))&&a+1<o&&56320==(64512&(r=t.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),c+=n<128?1:n<2048?2:n<65536?3:4;for(e=new i.Buf8(c),s=0,a=0;s<c;a++)55296==(64512&(n=t.charCodeAt(a)))&&a+1<o&&56320==(64512&(r=t.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|63&n):n<65536?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|63&n):(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|63&n);return e},e.buf2binstring=function(t){return c(t,t.length)},e.binstring2buf=function(t){for(var e=new i.Buf8(t.length),n=0,r=e.length;n<r;n++)e[n]=t.charCodeAt(n);return e},e.buf2string=function(t,e){var n,i,r,a,o=e||t.length,h=new Array(2*o);for(i=0,n=0;n<o;)if((r=t[n++])<128)h[i++]=r;else if((a=s[r])>4)h[i++]=65533,n+=a-1;else{for(r&=2===a?31:3===a?15:7;a>1&&n<o;)r=r<<6|63&t[n++],a--;a>1?h[i++]=65533:r<65536?h[i++]=r:(r-=65536,h[i++]=55296|r>>10&1023,h[i++]=56320|1023&r)}return c(h,i)},e.utf8border=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;n>=0&&128==(192&t[n]);)n--;return n<0?e:0===n?e:n+s[t[n]]>e?n:e}},function(t,e,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(t,e,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(t,e,n){var i;!function(n,r,a,s){"use strict";var o,c={URL:n.URL||n.webkitURL||n.mozURL||n.msURL,getUserMedia:(o=a.getUserMedia||a.webkitGetUserMedia||a.mozGetUserMedia||a.msGetUserMedia,o?o.bind(a):o),requestAnimFrame:n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame,requestTimeout:function(t,e){if(t=t||c.noop,e=e||0,!c.requestAnimFrame)return setTimeout(t,e);var n=(new Date).getTime(),i=new Object,r=c.requestAnimFrame;return i.value=r(function a(){(new Date).getTime()-n>=e?t.call():i.value=r(a)}),i},Blob:n.Blob||n.BlobBuilder||n.WebKitBlobBuilder||n.MozBlobBuilder||n.MSBlobBuilder,btoa:function(){var t=n.btoa||function(t){for(var e="",n=0,i=t.length,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=void 0,s=void 0,o=void 0,c=void 0,h=void 0,l=void 0,d=void 0;n<i;)c=(a=t.charCodeAt(n++))>>2,h=(3&a)<<4|(s=t.charCodeAt(n++))>>4,l=(15&s)<<2|(o=t.charCodeAt(n++))>>6,d=63&o,isNaN(s)?l=d=64:isNaN(o)&&(d=64),e=e+r.charAt(c)+r.charAt(h)+r.charAt(l)+r.charAt(d);return e};return t?t.bind(n):c.noop}(),isObject:function(t){return t&&"[object Object]"===Object.prototype.toString.call(t)},isEmptyObject:function(t){return c.isObject(t)&&!Object.keys(t).length},isArray:function(t){return t&&Array.isArray(t)},isFunction:function(t){return t&&"function"==typeof t},isElement:function(t){return t&&1===t.nodeType},isString:function(t){return"string"==typeof t||"[object String]"===Object.prototype.toString.call(t)},isSupported:{canvas:function(){var t=r.createElement("canvas");return t&&t.getContext&&t.getContext("2d")},webworkers:function(){return n.Worker},blob:function(){return c.Blob},Uint8Array:function(){return n.Uint8Array},Uint32Array:function(){return n.Uint32Array},videoCodecs:function(){var t=r.createElement("video"),e={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{t&&t.canPlayType&&(e.mp4=""!==t.canPlayType('video/mp4; codecs="mp4v.20.8"'),e.h264=""!==(t.canPlayType('video/mp4; codecs="avc1.42E01E"')||t.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),e.ogv=""!==t.canPlayType('video/ogg; codecs="theora"'),e.ogg=""!==t.canPlayType('video/ogg; codecs="theora"'),e.webm=-1!==t.canPlayType('video/webm; codecs="vp8, vorbis"'))}catch(t){}return e}()},noop:function(){},each:function(t,e){var n=void 0,i=void 0;if(c.isArray(t))for(n=-1,i=t.length;++n<i&&!1!==e(n,t[n]););else if(c.isObject(t))for(n in t)if(t.hasOwnProperty(n)&&!1===e(n,t[n]))break},mergeOptions:function(t,e){if(c.isObject(t)&&c.isObject(e)&&Object.keys){var n={};return c.each(t,function(e,i){n[e]=t[e]}),c.each(e,function(i,r){var a=e[i];c.isObject(a)&&t[i]?n[i]=c.mergeOptions(t[i],a):n[i]=a}),n}},setCSSAttr:function(t,e,n){c.isElement(t)&&(c.isString(e)&&c.isString(n)?t.style[e]=n:c.isObject(e)&&c.each(e,function(e,n){t.style[e]=n}))},removeElement:function(t){c.isElement(t)&&t.parentNode&&t.parentNode.removeChild(t)},createWebWorker:function(t){if(!c.isString(t))return{};try{var e=new c.Blob([t],{type:"text/javascript"}),n=c.URL.createObjectURL(e);return{objectUrl:n,worker:new Worker(n)}}catch(t){return""+t}},getExtension:function(t){return t.substr(t.lastIndexOf(".")+1,t.length)},getFontSize:function(){var t=arguments.length>0&&arguments[0]!==s?arguments[0]:{};if(!r.body||!1===t.resizeFont)return t.fontSize;var e=t.text,n=t.gifWidth,i=parseInt(t.fontSize,10),a=parseInt(t.minFontSize,10),o=r.createElement("div"),c=r.createElement("span");for(o.setAttribute("width",n),o.appendChild(c),c.innerHTML=e,c.style.fontSize=i+"px",c.style.textIndent="-9999px",c.style.visibility="hidden",r.body.appendChild(c);c.offsetWidth>n&&i>=a;)c.style.fontSize=--i+"px";return r.body.removeChild(c),i+"px"},webWorkerError:!1},h=Object.freeze({default:c}),l={validate:function(t){t=c.isObject(t)?t:{};var e={};return c.each(l.validators,function(n,i){var r=i.errorCode;if(!t[r]&&!i.condition)return(e=i).error=!0,!1}),delete e.condition,e},isValid:function(t){var e=!0!==l.validate(t).error;return e},validators:[{condition:c.isFunction(c.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:c.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:c.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:c.isFunction(c.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:c.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:c.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:c.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},d=Object.freeze({default:l}),u=function(){},f={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:u,completeCallback:u,saveRenderingContexts:!1,savedRenderingContexts:[],showFrameText:!0,crossOrigin:"Anonymous",waterMark:null,waterMarkHeight:null,waterMarkWidth:null,waterMarkXCoordinate:1,waterMarkYCoordinate:1},p=Object.freeze({default:f});function m(){return l.isValid()}function g(){var t,e,n,i,r,a=256,s=499,o=491,c=487,h=503,l=3*h,d=a-1,u=4,f=100,p=16,m=1<<p,g=10,v=10,_=m>>v,b=m<<g-v,w=6,y=(a>>3)*(1<<w),x=30,k=1024,S=256,C=1<<18,A=[],z=[],B=[],E=[];function T(t,e,n,i,s){var o,c,h,l,d,u,f;for((h=e-t)<-1&&(h=-1),(l=e+t)>a&&(l=a),o=e+1,c=e-1,u=1;o<l||c>h;){if(d=E[u++],o<l){f=r[o++];try{f[0]-=d*(f[0]-n)/C|0,f[1]-=d*(f[1]-i)/C|0,f[2]-=d*(f[2]-s)/C|0}catch(t){}}if(c>h){f=r[c--];try{f[0]-=d*(f[0]-n)/C|0,f[1]-=d*(f[1]-i)/C|0,f[2]-=d*(f[2]-s)/C|0}catch(t){}}}}function I(t,e,n,i,a){var s=r[e],o=t/k;s[0]-=o*(s[0]-n)|0,s[1]-=o*(s[1]-i)|0,s[2]-=o*(s[2]-a)|0}function R(t,e,n){var i,s,o,c,h,l,d,f,m,w;for(m=f=~(1<<31),d=l=-1,i=0;i<a;i++)(s=(w=r[i])[0]-t)<0&&(s=-s),(o=w[1]-e)<0&&(o=-o),s+=o,(o=w[2]-n)<0&&(o=-o),(s+=o)<f&&(f=s,l=i),(c=s-(z[i]>>p-u))<m&&(m=c,d=i),h=B[i]>>v,B[i]-=h,z[i]+=h<<g;return B[l]+=_,z[l]-=b,d}(function(t,s,o){var c,h;for(e=t,n=s,i=o,r=new Array(a),c=0;c<a;c++)r[c]=new Array(4),(h=r[c])[0]=h[1]=h[2]=(c<<u+8)/a|0,B[c]=m/a|0,z[c]=0}).apply(this,arguments);var D={map:function(t,e,n){var i,s,o,c,h,l,d;for(h=1e3,d=-1,s=(i=A[e])-1;i<a||s>=0;)i<a&&((o=(l=r[i])[1]-e)>=h?i=a:(i++,o<0&&(o=-o),(c=l[0]-t)<0&&(c=-c),(o+=c)<h&&((c=l[2]-n)<0&&(c=-c),(o+=c)<h&&(h=o,d=l[3])))),s>=0&&((o=e-(l=r[s])[1])>=h?s=-1:(s--,o<0&&(o=-o),(c=l[0]-t)<0&&(c=-c),(o+=c)<h&&((c=l[2]-n)<0&&(c=-c),(o+=c)<h&&(h=o,d=l[3]))));return d}};return D.process=function(){return function(){var r,a,d,p,m,g,v,_,b,C,A,z,B,D;for(n<l&&(i=1),t=30+(i-1)/3,z=e,B=0,D=n,C=(A=n/(3*i))/f|0,_=k,(v=(g=y)>>w)<=1&&(v=0),r=0;r<v;r++)E[r]=_*((v*v-r*r)*S/(v*v));for(b=n<l?3:n%s!=0?3*s:n%o!=0?3*o:n%c!=0?3*c:3*h,r=0;r<A;)if(I(_,a=R(d=(255&z[B+0])<<u,p=(255&z[B+1])<<u,m=(255&z[B+2])<<u),d,p,m),0!==v&&T(v,a,d,p,m),(B+=b)>=D&&(B-=n),0===C&&(C=1),++r%C==0)for(_-=_/t,(v=(g-=g/x)>>w)<=1&&(v=0),a=0;a<v;a++)E[a]=_*((v*v-a*a)*S/(v*v))}(),function(){var t;for(t=0;t<a;t++)r[t][0]>>=u,r[t][1]>>=u,r[t][2]>>=u,r[t][3]=t}(),function(){var t,e,n,i,s,o,c,h;for(c=0,h=0,t=0;t<a;t++){for(n=t,i=(s=r[t])[1],e=t+1;e<a;e++)(o=r[e])[1]<i&&(n=e,i=o[1]);if(o=r[n],t!=n&&(e=o[0],o[0]=s[0],s[0]=e,e=o[1],o[1]=s[1],s[1]=e,e=o[2],o[2]=s[2],s[2]=e,e=o[3],o[3]=s[3],s[3]=e),i!=c){for(A[c]=h+t>>1,e=c+1;e<i;e++)A[e]=t;c=i,h=t}}for(A[c]=h+d>>1,e=c+1;e<256;e++)A[e]=d}(),function(){for(var t=[],e=new Array(a),n=0;n<a;n++)e[r[n][3]]=n;for(var i=0,s=0;s<a;s++){var o=e[s];t[i++]=r[o][0],t[i++]=r[o][1],t[i++]=r[o][2]}return t}()},D}function v(){try{this.onmessage=function(e){var n,i=e.data||{};i.gifshot&&(n=t.run(i),postMessage(n))}}catch(t){}var t={dataToRGB:function(t,e,n){for(var i=e*n*4,r=0,a=[];r<i;)a.push(t[r++]),a.push(t[r++]),a.push(t[r++]),r++;return a},componentizedPaletteToArray:function(t){t=t||[];for(var e=[],n=0;n<t.length;n+=3){var i=t[n],r=t[n+1],a=t[n+2];e.push(i<<16|r<<8|a)}return e},processFrameWithQuantizer:function(t,e,n,i){for(var r=this.dataToRGB(t,e,n),a=new g(r,r.length,i),s=a.process(),o=new Uint32Array(this.componentizedPaletteToArray(s)),c=e*n,h=new Uint8Array(c),l=0,d=0;d<c;d++){var u=r[l++],f=r[l++],p=r[l++];h[d]=a.map(u,f,p)}return{pixels:h,palette:o}},run:function(t){var e=t=t||{},n=e.height,i=(e.palette,e.sampleInterval),r=e.width,a=t.data;return this.processFrameWithQuantizer(a,r,n,i)}};return t}function _(t,e,n,i){var r=0,a=(i=i===s?{}:i).loop===s?null:i.loop,o=i.palette===s?null:i.palette;if(e<=0||n<=0||e>65535||n>65535)throw"Width/Height invalid.";t[r++]=71,t[r++]=73,t[r++]=70,t[r++]=56,t[r++]=57,t[r++]=97;if(t[r++]=255&e,t[r++]=e>>8&255,t[r++]=255&n,t[r++]=n>>8&255,t[r++]=0|(null!==o?128:0),t[r++]=0,t[r++]=0,null!==a){if(a<0||a>65535)throw"Loop count invalid.";t[r++]=33,t[r++]=255,t[r++]=11,t[r++]=78,t[r++]=69,t[r++]=84,t[r++]=83,t[r++]=67,t[r++]=65,t[r++]=80,t[r++]=69,t[r++]=50,t[r++]=46,t[r++]=48,t[r++]=3,t[r++]=1,t[r++]=255&a,t[r++]=a>>8&255,t[r++]=0}var c=!1;this.addFrame=function(e,n,i,a,h,l){if(!0===c&&(--r,c=!1),l=l===s?{}:l,e<0||n<0||e>65535||n>65535)throw"x/y invalid.";if(i<=0||a<=0||i>65535||a>65535)throw"Width/Height invalid.";if(h.length<i*a)throw"Not enough pixels for the frame size.";var d=!0,u=l.palette;if(u!==s&&null!==u||(d=!1,u=o),u===s||null===u)throw"Must supply either a local or global palette.";for(var f=function(t){var e=t.length;if(e<2||e>256||e&e-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return e}(u),p=0;f>>=1;)++p;f=1<<p;var m=l.delay===s?0:l.delay,g=l.disposal===s?0:l.disposal;if(g<0||g>3)throw"Disposal out of range.";var v=!1,_=0;if(l.transparent!==s&&null!==l.transparent&&(v=!0,(_=l.transparent)<0||_>=f))throw"Transparent color index.";if((0!==g||v||0!==m)&&(t[r++]=33,t[r++]=249,t[r++]=4,t[r++]=g<<2|(!0===v?1:0),t[r++]=255&m,t[r++]=m>>8&255,t[r++]=_,t[r++]=0),t[r++]=44,t[r++]=255&e,t[r++]=e>>8&255,t[r++]=255&n,t[r++]=n>>8&255,t[r++]=255&i,t[r++]=i>>8&255,t[r++]=255&a,t[r++]=a>>8&255,t[r++]=!0===d?128|p-1:0,!0===d)for(var b=0,w=u.length;b<w;++b){var y=u[b];t[r++]=y>>16&255,t[r++]=y>>8&255,t[r++]=255&y}r=function(t,e,n,i){t[e++]=n;var r=e++,a=1<<n,o=a-1,c=a+1,h=c+1,l=n+1,d=0,u=0;function f(n){for(;d>=n;)t[e++]=255&u,u>>=8,d-=8,e===r+256&&(t[r]=255,r=e++)}function p(t){u|=t<<d,d+=l,f(8)}var m=i[0]&o,g={};p(a);for(var v=1,_=i.length;v<_;++v){var b=i[v]&o,w=m<<8|b,y=g[w];if(y===s){for(u|=m<<d,d+=l;d>=8;)t[e++]=255&u,u>>=8,d-=8,e===r+256&&(t[r]=255,r=e++);4096===h?(p(a),h=c+1,l=n+1,g={}):(h>=1<<l&&++l,g[w]=h++),m=b}else m=y}p(m),p(c),f(1),r+1===e?t[r]=0:(t[r]=e-r-1,t[e++]=0);return e}(t,r,p<2?2:p,h)},this.end=function(){return!1===c&&(t[r++]=59,c=!0),r}}var b=function(){},w=function(t){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=b,this.onRenderProgressCallback=b,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=t,this.initializeWebWorkers(t)};w.prototype={workerMethods:v(),initializeWebWorkers:function(t){var e,n=g.toString()+"("+v.toString()+"());",i=void 0,a=void 0,s=void 0,o=-1,h="";for(e=t.numWorkers;++o<e;)i=c.createWebWorker(n),c.isObject(i)?(a=i.objectUrl,s=i.worker,this.workers.push({worker:s,objectUrl:a}),this.availableWorkers.push(s)):(h=i,c.webWorkerError=!!i);this.workerError=h,this.canvas=r.createElement("canvas"),this.canvas.width=t.gifWidth,this.canvas.height=t.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(t){this.availableWorkers.push(t)},byteMap:function(){for(var t=[],e=0;e<256;e++)t[e]=String.fromCharCode(e);return t}(),bufferToString:function(t){for(var e=t.length,n="",i=-1;++i<e;)n+=this.byteMap[t[i]];return n},onFrameFinished:function(t){var e=this,n=e.frames,i=!!(e.options.images||[]).length,r=n.every(function(t){return!t.beingProcessed&&t.done});e.numRenderedFrames++,i&&t(e.numRenderedFrames/n.length),e.onRenderProgressCallback(.75*e.numRenderedFrames/n.length),r?e.generatingGIF||e.generateGIF(n,e.onRenderCompleteCallback):c.requestTimeout(function(){e.processNextFrame()},1)},processFrame:function(t){var e=this,n=(this.options,this.options),i=n.progressCallback,r=n.sampleInterval,a=this.frames,o=void 0,c=void 0,h=function(){var t=arguments.length>0&&arguments[0]!==s?arguments[0]:{},n=t.data;delete o.data,o.pixels=Array.prototype.slice.call(n.pixels),o.palette=Array.prototype.slice.call(n.palette),o.done=!0,o.beingProcessed=!1,e.freeWorker(c),e.onFrameFinished(i)};(o=a[t]).beingProcessed||o.done?this.onFrameFinished():(o.sampleInterval=r,o.beingProcessed=!0,o.gifshot=!0,(c=this.getWorker())?(c.onmessage=h,c.postMessage(o)):h({data:e.workerMethods.run(o)}))},startRendering:function(t){this.onRenderCompleteCallback=t;for(var e=0;e<this.options.numWorkers&&e<this.frames.length;e++)this.processFrame(e)},processNextFrame:function(){for(var t=-1,e=0;e<this.frames.length;e++){var n=this.frames[e];if(!n.done&&!n.beingProcessed){t=e;break}}t>=0&&this.processFrame(t)},generateGIF:function(t,e){var n=[],i={loop:this.repeat},r=this.options,a=r.interval,s=r.frameDuration,o=!!r.images.length,h=r.gifHeight,l=r.gifWidth,d=new _(n,l,h,i),u=this.onRenderProgressCallback,f=o?100*a:0,p=void 0;this.generatingGIF=!0,c.each(t,function(e,n){var i=n.palette;u(.75+.25*n.position*1/t.length);for(var r=0;r<s;r++)d.addFrame(0,0,l,h,n.pixels,{palette:i,delay:f})}),d.end(),u(1),this.frames=[],this.generatingGIF=!1,c.isFunction(e)&&(p=this.bufferToString(n),e("data:image/gif;base64,"+c.btoa(p)))},setRepeat:function(t){this.repeat=t},addFrame:function(t,e,n){e=c.isObject(e)?e:{};var i=this.ctx,r=this.options,a=r.gifWidth,s=r.gifHeight,o=c.getFontSize(e),h=e,l=h.filter,d=h.fontColor,u=h.fontFamily,f=h.fontWeight,p=(h.gifHeight,h.gifWidth,h.text),m=h.textAlign,g=h.textBaseline,v=h.waterMark,_=h.waterMarkHeight,b=h.waterMarkWidth,w=h.waterMarkXCoordinate,y=h.waterMarkYCoordinate,x=e.textXCoordinate?e.textXCoordinate:"left"===m?1:"right"===m?a:a/2,k=e.textYCoordinate?e.textYCoordinate:"top"===g?1:"center"===g?s/2:s,S=f+" "+o+" "+u,C=n&&e.showFrameText?n:p,A=void 0;try{i.filter=l,i.drawImage(t,0,0,a,s),C&&(i.font=S,i.fillStyle=d,i.textAlign=m,i.textBaseline=g,i.fillText(C,x,k)),v&&i.drawImage(v,w,y,b,_),A=i.getImageData(0,0,a,s),this.addFrameImageData(A)}catch(t){return""+t}},addFrameImageData:function(){var t=arguments.length>0&&arguments[0]!==s?arguments[0]:{},e=this.frames,n=t.data;this.frames.push({data:n,width:t.width,height:t.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:e.length})},onRenderProgress:function(t){this.onRenderProgressCallback=t},isRendering:function(){return this.generatingGIF},getBase64GIF:function(t){var e=this;e.startRendering(function(n){e.destroyWorkers(),c.requestTimeout(function(){t(n)},0)})},destroyWorkers:function(){if(!this.workerError){var t=this.workers;c.each(t,function(t,e){var n=e.worker,i=e.objectUrl;n.terminate(),c.URL.revokeObjectURL(i)})}}};var y=function(){},x={getGIF:function(){var t=arguments.length>0&&arguments[0]!==s?arguments[0]:{},e=arguments[1];e=c.isFunction(e)?e:y;var n=r.createElement("canvas"),i=void 0,a=t.images,o=!!a.length,h=t.cameraStream,l=t.crop,d=t.filter,u=t.fontColor,f=t.fontFamily,p=t.fontWeight,m=t.keepCameraOn,g=(t.numWorkers,t.progressCallback),v=t.saveRenderingContexts,_=t.savedRenderingContexts,b=t.text,x=t.textAlign,k=t.textBaseline,S=t.videoElement,C=t.videoHeight,A=t.videoWidth,z=t.webcamVideoElement,B=t.waterMark,E=t.waterMarkHeight,T=t.waterMarkWidth,I=t.waterMarkXCoordinate,R=t.waterMarkYCoordinate,D=Number(t.gifWidth),L=Number(t.gifHeight),F=Number(t.interval),q=(Number(t.sampleInterval),o?0:1e3*F),U=[],P=_.length?_.length:t.numFrames,O=P,M=new w(t),W=c.getFontSize(t),N=t.textXCoordinate?t.textXCoordinate:"left"===x?1:"right"===x?D:D/2,H=t.textYCoordinate?t.textYCoordinate:"top"===k?1:"center"===k?L/2:L,j=p+" "+W+" "+f,Z=l?Math.floor(l.scaledWidth/2):0,V=l?A-l.scaledWidth:0,G=l?Math.floor(l.scaledHeight/2):0,Y=l?C-l.scaledHeight:0,X=function t(){var n=O-1;function r(){var r;v&&U.push(i.getImageData(0,0,D,L)),B&&i.drawImage(B,I,R,T,E),b&&(i.font=j,i.fillStyle=u,i.textAlign=x,i.textBaseline=k,i.fillText(b,N,H)),r=i.getImageData(0,0,D,L),M.addFrameImageData(r),g((P-(O=n))/P),n>0&&c.requestTimeout(t,q),O||M.getBase64GIF(function(t){e({error:!1,errorCode:"",errorMsg:"",image:t,cameraStream:h,videoElement:S,webcamVideoElement:z,savedRenderingContexts:U,keepCameraOn:m})})}_.length?(i.putImageData(_[P-O],0,0),r()):function t(){try{V>A&&(V=A),Y>C&&(Y=C),Z<0&&(Z=0),G<0&&(G=0),i.filter=d,i.drawImage(S,Z,G,V,Y,0,0,D,L),r()}catch(e){if("NS_ERROR_NOT_AVAILABLE"!==e.name)throw e;c.requestTimeout(t,100)}}()};P=P!==s?P:10,F=F!==s?F:.1,n.width=D,n.height=L,i=n.getContext("2d"),function t(){_.length||0!==S.currentTime?X():c.requestTimeout(t,100)}()},getCropDimensions:function(){var t=arguments.length>0&&arguments[0]!==s?arguments[0]:{},e=t.videoWidth,n=t.videoHeight,i=t.gifWidth,r=t.gifHeight,a={width:0,height:0,scaledWidth:0,scaledHeight:0};return e>n?(a.width=Math.round(e*(r/n))-i,a.scaledWidth=Math.round(a.width*(n/r))):(a.height=Math.round(n*(i/e))-r,a.scaledHeight=Math.round(a.height*(e/i))),a}},k={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function t(e){t.attempts=t.attempts||0;var n=e.cameraStream,i=e.completedCallback,r=e.videoElement;r&&(r.videoWidth>0&&r.videoHeight>0?(r.removeEventListener("loadeddata",k.findVideoSize),i({videoElement:r,cameraStream:n,videoWidth:r.videoWidth,videoHeight:r.videoHeight})):t.attempts<10?(t.attempts+=1,c.requestTimeout(function(){k.findVideoSize(e)},400)):i({videoElement:r,cameraStream:n,videoWidth:k.defaultVideoDimensions.width,videoHeight:k.defaultVideoDimensions.height}))},onStreamingTimeout:function(t){c.isFunction(t)&&t({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(t){var e=c.isArray(t.existingVideo)?t.existingVideo[0]:t.existingVideo,n=t.cameraStream,i=t.completedCallback,r=t.streamedCallback,a=t.videoElement;if(c.isFunction(r)&&r(),e){if(c.isString(e))a.src=e,a.innerHTML='<source src="'+e+'" type="video/'+c.getExtension(e)+'" />';else if(e instanceof Blob){try{a.src=c.URL.createObjectURL(e)}catch(t){}a.innerHTML='<source src="'+e+'" type="'+e.type+'" />'}}else if(a.mozSrcObject)a.mozSrcObject=n;else if(c.URL)try{a.srcObject=n,a.src=c.URL.createObjectURL(n)}catch(t){a.srcObject=n}a.play(),c.requestTimeout(function t(){t.count=t.count||0,!0===k.loadedData?(k.findVideoSize({videoElement:a,cameraStream:n,completedCallback:i}),k.loadedData=!1):(t.count+=1)>10?k.findVideoSize({videoElement:a,cameraStream:n,completedCallback:i}):t()},0)},startStreaming:function(t){var e=c.isFunction(t.error)?t.error:c.noop,n=c.isFunction(t.streamed)?t.streamed:c.noop,i=c.isFunction(t.completed)?t.completed:c.noop,a=t.crossOrigin,s=t.existingVideo,o=t.lastCameraStream,h=t.options,l=t.webcamVideoElement,d=c.isElement(s)?s:l||r.createElement("video");a&&(d.crossOrigin=h.crossOrigin),d.autoplay=!0,d.loop=!0,d.muted=!0,d.addEventListener("loadeddata",function(t){k.loadedData=!0,h.offset&&(d.currentTime=h.offset)}),s?k.stream({videoElement:d,existingVideo:s,completedCallback:i}):o?k.stream({videoElement:d,cameraStream:o,streamedCallback:n,completedCallback:i}):c.getUserMedia({video:!0},function(t){k.stream({videoElement:d,cameraStream:t,streamedCallback:n,completedCallback:i})},e)},startVideoStreaming:function(t){var e=arguments.length>1&&arguments[1]!==s?arguments[1]:{},n=e.timeout!==s?e.timeout:0,i=e.callback,r=e.webcamVideoElement,a=void 0;n>0&&(a=c.requestTimeout(function(){k.onStreamingTimeout(i)},1e4)),k.startStreaming({error:function(){i({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(a)},completed:function(){var e=arguments.length>0&&arguments[0]!==s?arguments[0]:{},n=e.cameraStream,i=e.videoElement,r=e.videoHeight,a=e.videoWidth;t({cameraStream:n,videoElement:i,videoHeight:r,videoWidth:a})},lastCameraStream:e.lastCameraStream,webcamVideoElement:r,crossOrigin:e.crossOrigin,options:e})},stopVideoStreaming:function(t){var e=t=c.isObject(t)?t:{},n=e.keepCameraOn,i=e.videoElement,r=e.webcamVideoElement,a=t.cameraStream||{},s=a.getTracks&&a.getTracks()||[],o=!!s.length,h=s[0];!n&&o&&c.isFunction(h.stop)&&h.stop(),c.isElement(i)&&!r&&(i.pause(),c.isFunction(c.URL.revokeObjectURL)&&!c.webWorkerError&&i.src&&c.URL.revokeObjectURL(i.src),c.removeElement(i))}};function S(t){t=c.isObject(t)?t:{},k.stopVideoStreaming(t)}function C(t,e){var n=t.options||{},i=n.images,a=n.video,s=Number(n.gifWidth),o=Number(n.gifHeight),h=(Number(n.numFrames),t.cameraStream),l=t.videoElement,d=t.videoWidth,u=t.videoHeight,f=x.getCropDimensions({videoWidth:d,videoHeight:u,gifHeight:o,gifWidth:s}),p=e;n.crop=f,n.videoElement=l,n.videoWidth=d,n.videoHeight=u,n.cameraStream=h,c.isElement(l)&&(l.width=s+f.width,l.height=o+f.height,n.webcamVideoElement||(c.setCSSAttr(l,{position:"fixed",opacity:"0"}),r.body.appendChild(l)),l.play(),x.getGIF(n,function(t){i&&i.length||a&&a.length||S(t),p(t)}))}function A(t,e){if(e=c.isFunction(t)?t:e,t=c.isObject(t)?t:{},c.isFunction(e)){var n=c.mergeOptions(f,t)||{},i=t.cameraStream,a=n.images,o=a?a.length:0,h=n.video,d=n.webcamVideoElement;n=c.mergeOptions(n,{gifWidth:Math.floor(n.gifWidth),gifHeight:Math.floor(n.gifHeight)}),o?function(){var t=arguments.length>0&&arguments[0]!==s?arguments[0]:{},e=t.callback,n=t.images,i=t.options,a=t.imagesLength,o=l.validate({getUserMedia:!0,"window.URL":!0}),h=[],d=0,u=void 0,f=void 0;if(o.error)return e(o);function p(){c.each(h,function(t,e){e&&(e.text?f.addFrame(e.img,i,e.text):f.addFrame(e,i))}),function(t,e){t.getBase64GIF(function(t){e({error:!1,errorCode:"",errorMsg:"",image:t})})}(f,e)}f=new w(i),c.each(n,function(t,n){var s=n;n.src&&(s=s.src),c.isElement(s)?(i.crossOrigin&&(s.crossOrigin=i.crossOrigin),h[t]=s,(d+=1)===a&&p()):c.isString(s)&&(u=new Image,i.crossOrigin&&(u.crossOrigin=i.crossOrigin),function(i){n.text&&(i.text=n.text),i.onerror=function(t){var n=void 0;if(0===--a)return(n={}).error="None of the requested images was capable of being retrieved",e(n)},i.onload=function(e){n.text?h[t]={img:i,text:i.text}:h[t]=i,(d+=1)===a&&p(),c.removeElement(i)},i.src=s}(u),c.setCSSAttr(u,{position:"fixed",opacity:"0"}),r.body.appendChild(u))})}({images:a,imagesLength:o,callback:e,options:n}):h?function(){var t=arguments.length>0&&arguments[0]!==s?arguments[0]:{},e=t.callback,n=t.existingVideo,i=t.options,r=l.validate({getUserMedia:!0,"window.URL":!0}),a=void 0,o=void 0;if(r.error)return e(r);if(c.isElement(n)&&n.src){if(o=n.src,a=c.getExtension(o),!c.isSupported.videoCodecs[a])return e(l.messages.videoCodecs)}else c.isArray(n)&&c.each(n,function(t,e){if(a=e instanceof Blob?e.type.substr(e.type.lastIndexOf("/")+1,e.length):e.substr(e.lastIndexOf(".")+1,e.length),c.isSupported.videoCodecs[a])return n=e,!1});k.startStreaming({completed:function(t){t.options=i||{},C(t,e)},existingVideo:n,crossOrigin:i.crossOrigin,options:i})}({existingVideo:h,callback:e,options:n}):function(){var t=arguments.length>0&&arguments[0]!==s?arguments[0]:{},e=t.callback,n=t.lastCameraStream,i=t.options,r=t.webcamVideoElement;if(!m())return e(l.validate());i.savedRenderingContexts.length?x.getGIF(i,function(t){e(t)}):k.startVideoStreaming(function(){var t=arguments.length>0&&arguments[0]!==s?arguments[0]:{};t.options=i||{},C(t,e)},{lastCameraStream:n,callback:e,webcamVideoElement:r,crossOrigin:i.crossOrigin})}({lastCameraStream:i,callback:e,webcamVideoElement:d,options:n})}}var z={utils:h,error:d,defaultOptions:p,createGIF:A,takeSnapShot:function(t,e){if(e=c.isFunction(t)?t:e,t=c.isObject(t)?t:{},c.isFunction(e)){var n=c.mergeOptions(f,t);A(c.mergeOptions(n,{interval:.1,numFrames:1,gifWidth:Math.floor(n.gifWidth),gifHeight:Math.floor(n.gifHeight)}),e)}},stopVideoStreaming:S,isSupported:function(){return l.isValid()},isWebCamGIFSupported:m,isExistingVideoGIFSupported:function(t){var e=!1;if(c.isArray(t)&&t.length){if(c.each(t,function(t,n){c.isSupported.videoCodecs[n]&&(e=!0)}),!e)return!1}else if(c.isString(t)&&t.length&&!c.isSupported.videoCodecs[t])return!1;return l.isValid({getUserMedia:!0})},isExistingImagesGIFSupported:function(){return l.isValid({getUserMedia:!0})},VERSION:"0.4.5"};(i=function(){return z}.apply(e,[]))===s||(t.exports=i)}("undefined"!=typeof window?window:{},"undefined"!=typeof document?document:{createElement:function(){}},"undefined"!=typeof window?window.navigator:{})},function(t,e,n){(function(e){var i;i={},t.exports=i,function(t,e){t.toRGBA8=function(e){var n=e.width,i=e.height;if(null==e.tabs.acTL)return[t.toRGBA8.decodeImage(e.data,n,i,e).buffer];var r=[];null==e.frames[0].data&&(e.frames[0].data=e.data);for(var a,s=new Uint8Array(n*i*4),o=0;o<e.frames.length;o++){var c=e.frames[o],h=c.rect.x,l=c.rect.y,d=c.rect.width,u=c.rect.height,f=t.toRGBA8.decodeImage(c.data,d,u,e);if(0==o?a=f:0==c.blend?t._copyTile(f,d,u,a,n,i,h,l,0):1==c.blend&&t._copyTile(f,d,u,a,n,i,h,l,1),r.push(a.buffer),a=a.slice(0),0==c.dispose);else if(1==c.dispose)t._copyTile(s,d,u,a,n,i,h,l,0);else if(2==c.dispose){for(var p=o-1;2==e.frames[p].dispose;)p--;a=new Uint8Array(r[p]).slice(0)}}return r},t.toRGBA8.decodeImage=function(e,n,i,r){var a=n*i,s=t.decode._getBPP(r),o=Math.ceil(n*s/8),c=new Uint8Array(4*a),h=new Uint32Array(c.buffer),l=r.ctype,d=r.depth,u=t._bin.readUshort;if(6==l){var f=a<<2;if(8==d)for(var p=0;p<f;p++)c[p]=e[p];if(16==d)for(p=0;p<f;p++)c[p]=e[p<<1]}else if(2==l){var m=r.tabs.tRNS,g=-1,v=-1,_=-1;if(m&&(g=m[0],v=m[1],_=m[2]),8==d)for(p=0;p<a;p++){var b=3*p;c[A=p<<2]=e[b],c[A+1]=e[b+1],c[A+2]=e[b+2],c[A+3]=255,-1!=g&&e[b]==g&&e[b+1]==v&&e[b+2]==_&&(c[A+3]=0)}if(16==d)for(p=0;p<a;p++)b=6*p,c[A=p<<2]=e[b],c[A+1]=e[b+2],c[A+2]=e[b+4],c[A+3]=255,-1!=g&&u(e,b)==g&&u(e,b+2)==v&&u(e,b+4)==_&&(c[A+3]=0)}else if(3==l){var w=r.tabs.PLTE,y=r.tabs.tRNS,x=y?y.length:0;if(1==d)for(var k=0;k<i;k++){var S=k*o,C=k*n;for(p=0;p<n;p++){var A=C+p<<2,z=3*(B=e[S+(p>>3)]>>7-((7&p)<<0)&1);c[A]=w[z],c[A+1]=w[z+1],c[A+2]=w[z+2],c[A+3]=B<x?y[B]:255}}if(2==d)for(k=0;k<i;k++)for(S=k*o,C=k*n,p=0;p<n;p++)A=C+p<<2,z=3*(B=e[S+(p>>2)]>>6-((3&p)<<1)&3),c[A]=w[z],c[A+1]=w[z+1],c[A+2]=w[z+2],c[A+3]=B<x?y[B]:255;if(4==d)for(k=0;k<i;k++)for(S=k*o,C=k*n,p=0;p<n;p++)A=C+p<<2,z=3*(B=e[S+(p>>1)]>>4-((1&p)<<2)&15),c[A]=w[z],c[A+1]=w[z+1],c[A+2]=w[z+2],c[A+3]=B<x?y[B]:255;if(8==d)for(p=0;p<a;p++){var B;A=p<<2,z=3*(B=e[p]),c[A]=w[z],c[A+1]=w[z+1],c[A+2]=w[z+2],c[A+3]=B<x?y[B]:255}}else if(4==l){if(8==d)for(p=0;p<a;p++){A=p<<2;var E=e[T=p<<1];c[A]=E,c[A+1]=E,c[A+2]=E,c[A+3]=e[T+1]}if(16==d)for(p=0;p<a;p++){var T;A=p<<2,E=e[T=p<<2],c[A]=E,c[A+1]=E,c[A+2]=E,c[A+3]=e[T+2]}}else if(0==l){if(g=r.tabs.tRNS?r.tabs.tRNS:-1,1==d)for(p=0;p<a;p++){var I=(E=255*(e[p>>3]>>7-(7&p)&1))==255*g?0:255;h[p]=I<<24|E<<16|E<<8|E}if(2==d)for(p=0;p<a;p++)I=(E=85*(e[p>>2]>>6-((3&p)<<1)&3))==85*g?0:255,h[p]=I<<24|E<<16|E<<8|E;if(4==d)for(p=0;p<a;p++)I=(E=17*(e[p>>1]>>4-((1&p)<<2)&15))==17*g?0:255,h[p]=I<<24|E<<16|E<<8|E;if(8==d)for(p=0;p<a;p++)I=(E=e[p])==g?0:255,h[p]=I<<24|E<<16|E<<8|E;if(16==d)for(p=0;p<a;p++)E=e[p<<1],I=u(e,p<<1)==g?0:255,h[p]=I<<24|E<<16|E<<8|E}return c},t.decode=function(e){for(var n,i=new Uint8Array(e),r=8,a=t._bin,s=a.readUshort,o=a.readUint,c={tabs:{},frames:[]},h=new Uint8Array(i.length),l=0,d=0,u=[137,80,78,71,13,10,26,10],f=0;f<8;f++)if(i[f]!=u[f])throw"The input is not a PNG file!";for(;r<i.length;){var p=a.readUint(i,r);r+=4;var m=a.readASCII(i,r,4);if(r+=4,"IHDR"==m)t.decode._IHDR(i,r,c);else if("IDAT"==m){for(f=0;f<p;f++)h[l+f]=i[r+f];l+=p}else if("acTL"==m)c.tabs[m]={num_frames:o(i,r),num_plays:o(i,r+4)},n=new Uint8Array(i.length);else if("fcTL"==m){var g;0!=d&&((g=c.frames[c.frames.length-1]).data=t.decode._decompress(c,n.slice(0,d),g.rect.width,g.rect.height),d=0);var v={x:o(i,r+12),y:o(i,r+16),width:o(i,r+4),height:o(i,r+8)},_=s(i,r+22);_=s(i,r+20)/(0==_?100:_);var b={rect:v,delay:Math.round(1e3*_),dispose:i[r+24],blend:i[r+25]};c.frames.push(b)}else if("fdAT"==m){for(f=0;f<p-4;f++)n[d+f]=i[r+f+4];d+=p-4}else if("pHYs"==m)c.tabs[m]=[a.readUint(i,r),a.readUint(i,r+4),i[r+8]];else if("cHRM"==m)for(c.tabs[m]=[],f=0;f<8;f++)c.tabs[m].push(a.readUint(i,r+4*f));else if("tEXt"==m){null==c.tabs[m]&&(c.tabs[m]={});var w=a.nextZero(i,r),y=a.readASCII(i,r,w-r),x=a.readASCII(i,w+1,r+p-w-1);c.tabs[m][y]=x}else if("iTXt"==m){null==c.tabs[m]&&(c.tabs[m]={}),w=0;var k=r;w=a.nextZero(i,k),y=a.readASCII(i,k,w-k),i[k=w+1],i[k+1],k+=2,w=a.nextZero(i,k),a.readASCII(i,k,w-k),k=w+1,w=a.nextZero(i,k),a.readUTF8(i,k,w-k),k=w+1,x=a.readUTF8(i,k,p-(k-r)),c.tabs[m][y]=x}else if("PLTE"==m)c.tabs[m]=a.readBytes(i,r,p);else if("hIST"==m){var S=c.tabs.PLTE.length/3;for(c.tabs[m]=[],f=0;f<S;f++)c.tabs[m].push(s(i,r+2*f))}else if("tRNS"==m)3==c.ctype?c.tabs[m]=a.readBytes(i,r,p):0==c.ctype?c.tabs[m]=s(i,r):2==c.ctype&&(c.tabs[m]=[s(i,r),s(i,r+2),s(i,r+4)]);else if("gAMA"==m)c.tabs[m]=a.readUint(i,r)/1e5;else if("sRGB"==m)c.tabs[m]=i[r];else if("bKGD"==m)0==c.ctype||4==c.ctype?c.tabs[m]=[s(i,r)]:2==c.ctype||6==c.ctype?c.tabs[m]=[s(i,r),s(i,r+2),s(i,r+4)]:3==c.ctype&&(c.tabs[m]=i[r]);else if("IEND"==m)break;r+=p,a.readUint(i,r),r+=4}return 0!=d&&((g=c.frames[c.frames.length-1]).data=t.decode._decompress(c,n.slice(0,d),g.rect.width,g.rect.height),d=0),c.data=t.decode._decompress(c,h,c.width,c.height),delete c.compress,delete c.interlace,delete c.filter,c},t.decode._decompress=function(e,n,i,r){return 0==e.compress&&(n=t.decode._inflate(n)),0==e.interlace?n=t.decode._filterZero(n,e,0,i,r):1==e.interlace&&(n=t.decode._readInterlace(n,e)),n},t.decode._inflate=function(t){return e.inflate(t)},t.decode._readInterlace=function(e,n){for(var i=n.width,r=n.height,a=t.decode._getBPP(n),s=a>>3,o=Math.ceil(i*a/8),c=new Uint8Array(r*o),h=0,l=[0,0,4,0,2,0,1],d=[0,4,0,2,0,1,0],u=[8,8,8,4,4,2,2],f=[8,8,4,4,2,2,1],p=0;p<7;){for(var m=u[p],g=f[p],v=0,_=0,b=l[p];b<r;)b+=m,_++;for(var w=d[p];w<i;)w+=g,v++;var y=Math.ceil(v*a/8);t.decode._filterZero(e,n,h,v,_);for(var x=0,k=l[p];k<r;){for(var S=d[p],C=h+x*y<<3;S<i;){var A;if(1==a&&(A=(A=e[C>>3])>>7-(7&C)&1,c[k*o+(S>>3)]|=A<<7-((3&S)<<0)),2==a&&(A=(A=e[C>>3])>>6-(7&C)&3,c[k*o+(S>>2)]|=A<<6-((3&S)<<1)),4==a&&(A=(A=e[C>>3])>>4-(7&C)&15,c[k*o+(S>>1)]|=A<<4-((1&S)<<2)),a>=8)for(var z=k*o+S*s,B=0;B<s;B++)c[z+B]=e[(C>>3)+B];C+=a,S+=g}x++,k+=m}v*_!=0&&(h+=_*(1+y)),p+=1}return c},t.decode._getBPP=function(t){return[1,null,3,1,2,null,4][t.ctype]*t.depth},t.decode._filterZero=function(e,n,i,r,a){var s=t.decode._getBPP(n),o=Math.ceil(r*s/8),c=t.decode._paeth;s=Math.ceil(s/8);for(var h=0;h<a;h++){var l=i+h*o,d=l+h+1,u=e[d-1];if(0==u)for(var f=0;f<o;f++)e[l+f]=e[d+f];else if(1==u){for(f=0;f<s;f++)e[l+f]=e[d+f];for(f=s;f<o;f++)e[l+f]=e[d+f]+e[l+f-s]&255}else if(0==h){for(f=0;f<s;f++)e[l+f]=e[d+f];if(2==u)for(f=s;f<o;f++)e[l+f]=255&e[d+f];if(3==u)for(f=s;f<o;f++)e[l+f]=e[d+f]+(e[l+f-s]>>1)&255;if(4==u)for(f=s;f<o;f++)e[l+f]=e[d+f]+c(e[l+f-s],0,0)&255}else{if(2==u)for(f=0;f<o;f++)e[l+f]=e[d+f]+e[l+f-o]&255;if(3==u){for(f=0;f<s;f++)e[l+f]=e[d+f]+(e[l+f-o]>>1)&255;for(f=s;f<o;f++)e[l+f]=e[d+f]+(e[l+f-o]+e[l+f-s]>>1)&255}if(4==u){for(f=0;f<s;f++)e[l+f]=e[d+f]+c(0,e[l+f-o],0)&255;for(f=s;f<o;f++)e[l+f]=e[d+f]+c(e[l+f-s],e[l+f-o],e[l+f-s-o])&255}}}return e},t.decode._paeth=function(t,e,n){var i=t+e-n,r=Math.abs(i-t),a=Math.abs(i-e),s=Math.abs(i-n);return r<=a&&r<=s?t:a<=s?e:n},t.decode._IHDR=function(e,n,i){var r=t._bin;i.width=r.readUint(e,n),n+=4,i.height=r.readUint(e,n),n+=4,i.depth=e[n],n++,i.ctype=e[n],n++,i.compress=e[n],n++,i.filter=e[n],n++,i.interlace=e[n],n++},t._bin={nextZero:function(t,e){for(;0!=t[e];)e++;return e},readUshort:function(t,e){return t[e]<<8|t[e+1]},writeUshort:function(t,e,n){t[e]=n>>8&255,t[e+1]=255&n},readUint:function(t,e){return 16777216*t[e]+(t[e+1]<<16|t[e+2]<<8|t[e+3])},writeUint:function(t,e,n){t[e]=n>>24&255,t[e+1]=n>>16&255,t[e+2]=n>>8&255,t[e+3]=255&n},readASCII:function(t,e,n){for(var i="",r=0;r<n;r++)i+=String.fromCharCode(t[e+r]);return i},writeASCII:function(t,e,n){for(var i=0;i<n.length;i++)t[e+i]=n.charCodeAt(i)},readBytes:function(t,e,n){for(var i=[],r=0;r<n;r++)i.push(t[e+r]);return i},pad:function(t){return t.length<2?"0"+t:t},readUTF8:function(e,n,i){for(var r,a="",s=0;s<i;s++)a+="%"+t._bin.pad(e[n+s].toString(16));try{r=decodeURIComponent(a)}catch(r){return t._bin.readASCII(e,n,i)}return r}},t._copyTile=function(t,e,n,i,r,a,s,o,c){for(var h=Math.min(e,r),l=Math.min(n,a),d=0,u=0,f=0;f<l;f++)for(var p=0;p<h;p++)if(s>=0&&o>=0?(d=f*e+p<<2,u=(o+f)*r+s+p<<2):(d=(-o+f)*e-s+p<<2,u=f*r+p<<2),0==c)i[u]=t[d],i[u+1]=t[d+1],i[u+2]=t[d+2],i[u+3]=t[d+3];else if(1==c){var m=t[d+3]*(1/255),g=t[d]*m,v=t[d+1]*m,_=t[d+2]*m,b=i[u+3]*(1/255),w=i[u]*b,y=i[u+1]*b,x=i[u+2]*b,k=1-m,S=m+b*k,C=0==S?0:1/S;i[u+3]=255*S,i[u+0]=(g+w*k)*C,i[u+1]=(v+y*k)*C,i[u+2]=(_+x*k)*C}else if(2==c)m=t[d+3],g=t[d],v=t[d+1],_=t[d+2],b=i[u+3],w=i[u],y=i[u+1],x=i[u+2],m==b&&g==w&&v==y&&_==x?(i[u]=0,i[u+1]=0,i[u+2]=0,i[u+3]=0):(i[u]=g,i[u+1]=v,i[u+2]=_,i[u+3]=m);else if(3==c){if(m=t[d+3],g=t[d],v=t[d+1],_=t[d+2],b=i[u+3],w=i[u],y=i[u+1],x=i[u+2],m==b&&g==w&&v==y&&_==x)continue;if(m<220&&b>20)return!1}return!0},t.encode=function(e,n,i,r,a,s){null==r&&(r=0),null==s&&(s=!1);var o=t.encode.compress(e,n,i,r,!1,s);return t.encode.compressPNG(o,-1),t.encode._main(o,n,i,a)},t.encodeLL=function(e,n,i,r,a,s,o){for(var c={ctype:0+(1==r?0:2)+(0==a?0:4),depth:s,frames:[]},h=(r+a)*s,l=h*n,d=0;d<e.length;d++)c.frames.push({rect:{x:0,y:0,width:n,height:i},img:new Uint8Array(e[d]),blend:0,dispose:1,bpp:Math.ceil(h/8),bpl:Math.ceil(l/8)});return t.encode.compressPNG(c,4),t.encode._main(c,n,i,o)},t.encode._main=function(e,n,i,r){var a=t.crc.crc,s=t._bin.writeUint,o=t._bin.writeUshort,c=t._bin.writeASCII,h=8,l=e.frames.length>1,d=!1,u=46+(l?20:0);if(3==e.ctype){for(var f=e.plte.length,p=0;p<f;p++)e.plte[p]>>>24!=255&&(d=!0);u+=8+3*f+4+(d?8+1*f+4:0)}for(var m=0;m<e.frames.length;m++)l&&(u+=38),u+=(S=e.frames[m]).cimg.length+12,0!=m&&(u+=4);u+=12;var g=new Uint8Array(u),v=[137,80,78,71,13,10,26,10];for(p=0;p<8;p++)g[p]=v[p];if(s(g,h,13),c(g,h+=4,"IHDR"),s(g,h+=4,n),s(g,h+=4,i),g[h+=4]=e.depth,g[++h]=e.ctype,g[++h]=0,g[++h]=0,g[++h]=0,s(g,++h,a(g,h-17,17)),s(g,h+=4,1),c(g,h+=4,"sRGB"),g[h+=4]=1,s(g,++h,a(g,h-5,5)),h+=4,l&&(s(g,h,8),c(g,h+=4,"acTL"),s(g,h+=4,e.frames.length),s(g,h+=4,0),s(g,h+=4,a(g,h-12,12)),h+=4),3==e.ctype){for(s(g,h,3*(f=e.plte.length)),c(g,h+=4,"PLTE"),h+=4,p=0;p<f;p++){var _=3*p,b=e.plte[p],w=255&b,y=b>>>8&255,x=b>>>16&255;g[h+_+0]=w,g[h+_+1]=y,g[h+_+2]=x}if(s(g,h+=3*f,a(g,h-3*f-4,3*f+4)),h+=4,d){for(s(g,h,f),c(g,h+=4,"tRNS"),h+=4,p=0;p<f;p++)g[h+p]=e.plte[p]>>>24&255;s(g,h+=f,a(g,h-f-4,f+4)),h+=4}}var k=0;for(m=0;m<e.frames.length;m++){var S=e.frames[m];l&&(s(g,h,26),c(g,h+=4,"fcTL"),s(g,h+=4,k++),s(g,h+=4,S.rect.width),s(g,h+=4,S.rect.height),s(g,h+=4,S.rect.x),s(g,h+=4,S.rect.y),o(g,h+=4,r[m]),o(g,h+=2,1e3),g[h+=2]=S.dispose,g[++h]=S.blend,s(g,++h,a(g,h-30,30)),h+=4);var C=S.cimg;s(g,h,(f=C.length)+(0==m?0:4));var A=h+=4;for(c(g,h,0==m?"IDAT":"fdAT"),h+=4,0!=m&&(s(g,h,k++),h+=4),p=0;p<f;p++)g[h+p]=C[p];s(g,h+=f,a(g,A,h-A)),h+=4}return s(g,h,0),c(g,h+=4,"IEND"),s(g,h+=4,a(g,h-4,4)),h+=4,g.buffer},t.encode.compressPNG=function(e,n){for(var i=0;i<e.frames.length;i++){var r=e.frames[i],a=(r.rect.width,r.rect.height),s=new Uint8Array(a*r.bpl+a);r.cimg=t.encode._filterZero(r.img,a,r.bpp,r.bpl,s,n)}},t.encode.compress=function(e,n,i,r,a,s){null==s&&(s=!1);for(var o=6,c=8,h=255,l=0;l<e.length;l++)for(var d=new Uint8Array(e[l]),u=d.length,f=0;f<u;f+=4)h&=d[f+3];var p=255!=h,m=p&&a,g=t.encode.framize(e,n,i,a,m),v={},_=[],b=[];if(0!=r){var w=[];for(f=0;f<g.length;f++)w.push(g[f].img.buffer);var y=t.encode.concatRGBA(w,a),x=t.quantize(y,r),k=0,S=new Uint8Array(x.abuf);for(f=0;f<g.length;f++){var C=(H=g[f].img).length;for(b.push(new Uint8Array(x.inds.buffer,k>>2,C>>2)),l=0;l<C;l+=4)H[l]=S[k+l],H[l+1]=S[k+l+1],H[l+2]=S[k+l+2],H[l+3]=S[k+l+3];k+=C}for(f=0;f<x.plte.length;f++)_.push(x.plte[f].est.rgba)}else for(l=0;l<g.length;l++){var A=g[l],z=new Uint32Array(A.img.buffer),B=A.rect.width,E=(u=z.length,new Uint8Array(u));for(b.push(E),f=0;f<u;f++){var T=z[f];if(0!=f&&T==z[f-1])E[f]=E[f-1];else if(f>B&&T==z[f-B])E[f]=E[f-B];else{var I=v[T];if(null==I&&(v[T]=I=_.length,_.push(T),_.length>=300))break;E[f]=I}}}var R=_.length;for(R<=256&&0==s&&(c=R<=2?1:R<=4?2:R<=16?4:8,a&&(c=8)),l=0;l<g.length;l++){(A=g[l]).rect.x,A.rect.y,B=A.rect.width;var D=A.rect.height,L=A.img,F=(new Uint32Array(L.buffer),4*B),q=4;if(R<=256&&0==s){F=Math.ceil(c*B/8);for(var U=new Uint8Array(F*D),P=b[l],O=0;O<D;O++){f=O*F;var M=O*B;if(8==c)for(var W=0;W<B;W++)U[f+W]=P[M+W];else if(4==c)for(W=0;W<B;W++)U[f+(W>>1)]|=P[M+W]<<4-4*(1&W);else if(2==c)for(W=0;W<B;W++)U[f+(W>>2)]|=P[M+W]<<6-2*(3&W);else if(1==c)for(W=0;W<B;W++)U[f+(W>>3)]|=P[M+W]<<7-1*(7&W)}L=U,o=3,q=1}else if(0==p&&1==g.length){U=new Uint8Array(B*D*3);var N=B*D;for(f=0;f<N;f++){var H,j=4*f;U[H=3*f]=L[j],U[H+1]=L[j+1],U[H+2]=L[j+2]}L=U,o=2,q=3,F=3*B}A.img=L,A.bpl=F,A.bpp=q}return{ctype:o,depth:c,plte:_,frames:g}},t.encode.framize=function(e,n,i,r,a){for(var s=[],o=0;o<e.length;o++){var c=new Uint8Array(e[o]),h=new Uint32Array(c.buffer),l=0,d=0,u=n,f=i,p=0;if(0==o||a)c=c.slice(0);else{for(var m=r||1==o||2==s[s.length-2].dispose?1:2,g=0,v=1e9,_=0;_<m;_++){for(var b=new Uint8Array(e[o-1-_]),w=new Uint32Array(e[o-1-_]),y=n,x=i,k=-1,S=-1,C=0;C<i;C++)for(var A=0;A<n;A++){var z=C*n+A;h[z]!=w[z]&&(A<y&&(y=A),A>k&&(k=A),C<x&&(x=C),C>S&&(S=C))}var B=-1==k?1:(k-y+1)*(S-x+1);B<v&&(v=B,g=_,-1==k?(l=d=0,u=f=1):(l=y,d=x,u=k-y+1,f=S-x+1))}b=new Uint8Array(e[o-1-g]),1==g&&(s[s.length-1].dispose=2);var E=new Uint8Array(u*f*4);new Uint32Array(E.buffer),t._copyTile(b,n,i,E,u,f,-l,-d,0),t._copyTile(c,n,i,E,u,f,-l,-d,3)?(t._copyTile(c,n,i,E,u,f,-l,-d,2),p=1):(t._copyTile(c,n,i,E,u,f,-l,-d,0),p=0),c=E}s.push({rect:{x:l,y:d,width:u,height:f},img:c,blend:p,dispose:a?1:0})}return s},t.encode._filterZero=function(n,i,r,a,s,o){if(-1!=o){for(var c=0;c<i;c++)t.encode._filterLine(s,n,c,a,r,o);return e.deflate(s)}for(var h=[],l=0;l<5;l++)if(!(i*a>5e5)||2!=l&&3!=l&&4!=l){for(c=0;c<i;c++)t.encode._filterLine(s,n,c,a,r,l);if(h.push(e.deflate(s)),1==r)break}for(var d,u=1e9,f=0;f<h.length;f++)h[f].length<u&&(d=f,u=h[f].length);return h[d]},t.encode._filterLine=function(e,n,i,r,a,s){var o=i*r,c=o+i,h=t.decode._paeth;if(e[c]=s,c++,0==s)for(var l=0;l<r;l++)e[c+l]=n[o+l];else if(1==s){for(l=0;l<a;l++)e[c+l]=n[o+l];for(l=a;l<r;l++)e[c+l]=n[o+l]-n[o+l-a]+256&255}else if(0==i){for(l=0;l<a;l++)e[c+l]=n[o+l];if(2==s)for(l=a;l<r;l++)e[c+l]=n[o+l];if(3==s)for(l=a;l<r;l++)e[c+l]=n[o+l]-(n[o+l-a]>>1)+256&255;if(4==s)for(l=a;l<r;l++)e[c+l]=n[o+l]-h(n[o+l-a],0,0)+256&255}else{if(2==s)for(l=0;l<r;l++)e[c+l]=n[o+l]+256-n[o+l-r]&255;if(3==s){for(l=0;l<a;l++)e[c+l]=n[o+l]+256-(n[o+l-r]>>1)&255;for(l=a;l<r;l++)e[c+l]=n[o+l]+256-(n[o+l-r]+n[o+l-a]>>1)&255}if(4==s){for(l=0;l<a;l++)e[c+l]=n[o+l]+256-h(0,n[o+l-r],0)&255;for(l=a;l<r;l++)e[c+l]=n[o+l]+256-h(n[o+l-a],n[o+l-r],n[o+l-a-r])&255}}},t.crc={table:function(){for(var t=new Uint32Array(256),e=0;e<256;e++){for(var n=e,i=0;i<8;i++)1&n?n=3988292384^n>>>1:n>>>=1;t[e]=n}return t}(),update:function(e,n,i,r){for(var a=0;a<r;a++)e=t.crc.table[255&(e^n[i+a])]^e>>>8;return e},crc:function(e,n,i){return 4294967295^t.crc.update(4294967295,e,n,i)}},t.quantize=function(e,n){for(var i=new Uint8Array(e),r=i.slice(0),a=new Uint32Array(r.buffer),s=t.quantize.getKDtree(r,n),o=s[0],c=s[1],h=(t.quantize.planeDst,i),l=a,d=h.length,u=new Uint8Array(i.length>>2),f=0;f<d;f+=4){var p=h[f]*(1/255),m=h[f+1]*(1/255),g=h[f+2]*(1/255),v=h[f+3]*(1/255),_=t.quantize.getNearest(o,p,m,g,v);u[f>>2]=_.ind,l[f>>2]=_.est.rgba}return{abuf:r.buffer,inds:u,plte:c}},t.quantize.getKDtree=function(e,n,i){null==i&&(i=1e-4);var r=new Uint32Array(e.buffer),a={i0:0,i1:e.length,bst:null,est:null,tdst:0,left:null,right:null};a.bst=t.quantize.stats(e,a.i0,a.i1),a.est=t.quantize.estats(a.bst);for(var s=[a];s.length<n;){for(var o=0,c=0,h=0;h<s.length;h++)s[h].est.L>o&&(o=s[h].est.L,c=h);if(o<i)break;var l=s[c],d=t.quantize.splitPixels(e,r,l.i0,l.i1,l.est.e,l.est.eMq255);if(l.i0>=d||l.i1<=d)l.est.L=0;else{var u={i0:l.i0,i1:d,bst:null,est:null,tdst:0,left:null,right:null};u.bst=t.quantize.stats(e,u.i0,u.i1),u.est=t.quantize.estats(u.bst);var f={i0:d,i1:l.i1,bst:null,est:null,tdst:0,left:null,right:null};for(f.bst={R:[],m:[],N:l.bst.N-u.bst.N},h=0;h<16;h++)f.bst.R[h]=l.bst.R[h]-u.bst.R[h];for(h=0;h<4;h++)f.bst.m[h]=l.bst.m[h]-u.bst.m[h];f.est=t.quantize.estats(f.bst),l.left=u,l.right=f,s[c]=u,s.push(f)}}for(s.sort(function(t,e){return e.bst.N-t.bst.N}),h=0;h<s.length;h++)s[h].ind=h;return[a,s]},t.quantize.getNearest=function(e,n,i,r,a){if(null==e.left)return e.tdst=t.quantize.dist(e.est.q,n,i,r,a),e;var s=t.quantize.planeDst(e.est,n,i,r,a),o=e.left,c=e.right;s>0&&(o=e.right,c=e.left);var h=t.quantize.getNearest(o,n,i,r,a);if(h.tdst<=s*s)return h;var l=t.quantize.getNearest(c,n,i,r,a);return l.tdst<h.tdst?l:h},t.quantize.planeDst=function(t,e,n,i,r){var a=t.e;return a[0]*e+a[1]*n+a[2]*i+a[3]*r-t.eMq},t.quantize.dist=function(t,e,n,i,r){var a=e-t[0],s=n-t[1],o=i-t[2],c=r-t[3];return a*a+s*s+o*o+c*c},t.quantize.splitPixels=function(e,n,i,r,a,s){var o=t.quantize.vecDot;for(r-=4;i<r;){for(;o(e,i,a)<=s;)i+=4;for(;o(e,r,a)>s;)r-=4;if(i>=r)break;var c=n[i>>2];n[i>>2]=n[r>>2],n[r>>2]=c,i+=4,r-=4}for(;o(e,i,a)>s;)i-=4;return i+4},t.quantize.vecDot=function(t,e,n){return t[e]*n[0]+t[e+1]*n[1]+t[e+2]*n[2]+t[e+3]*n[3]},t.quantize.stats=function(t,e,n){for(var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=[0,0,0,0],a=n-e>>2,s=e;s<n;s+=4){var o=t[s]*(1/255),c=t[s+1]*(1/255),h=t[s+2]*(1/255),l=t[s+3]*(1/255);r[0]+=o,r[1]+=c,r[2]+=h,r[3]+=l,i[0]+=o*o,i[1]+=o*c,i[2]+=o*h,i[3]+=o*l,i[5]+=c*c,i[6]+=c*h,i[7]+=c*l,i[10]+=h*h,i[11]+=h*l,i[15]+=l*l}return i[4]=i[1],i[8]=i[2],i[9]=i[6],i[12]=i[3],i[13]=i[7],i[14]=i[11],{R:i,m:r,N:a}},t.quantize.estats=function(e){var n=e.R,i=e.m,r=e.N,a=i[0],s=i[1],o=i[2],c=i[3],h=0==r?0:1/r,l=[n[0]-a*a*h,n[1]-a*s*h,n[2]-a*o*h,n[3]-a*c*h,n[4]-s*a*h,n[5]-s*s*h,n[6]-s*o*h,n[7]-s*c*h,n[8]-o*a*h,n[9]-o*s*h,n[10]-o*o*h,n[11]-o*c*h,n[12]-c*a*h,n[13]-c*s*h,n[14]-c*o*h,n[15]-c*c*h],d=l,u=t.M4,f=[.5,.5,.5,.5],p=0,m=0;if(0!=r)for(var g=0;g<10&&(f=u.multVec(d,f),m=Math.sqrt(u.dot(f,f)),f=u.sml(1/m,f),!(Math.abs(m-p)<1e-9));g++)p=m;var v=[a*h,s*h,o*h,c*h];return{Cov:l,q:v,e:f,L:p,eMq255:u.dot(u.sml(255,v),f),eMq:u.dot(f,v),rgba:(Math.round(255*v[3])<<24|Math.round(255*v[2])<<16|Math.round(255*v[1])<<8|Math.round(255*v[0])<<0)>>>0}},t.M4={multVec:function(t,e){return[t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3],t[4]*e[0]+t[5]*e[1]+t[6]*e[2]+t[7]*e[3],t[8]*e[0]+t[9]*e[1]+t[10]*e[2]+t[11]*e[3],t[12]*e[0]+t[13]*e[1]+t[14]*e[2]+t[15]*e[3]]},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},sml:function(t,e){return[t*e[0],t*e[1],t*e[2],t*e[3]]}},t.encode.concatRGBA=function(t,e){for(var n=0,i=0;i<t.length;i++)n+=t[i].byteLength;var r=new Uint8Array(n),a=0;for(i=0;i<t.length;i++){for(var s=new Uint8Array(t[i]),o=s.length,c=0;c<o;c+=4){var h=s[c],l=s[c+1],d=s[c+2],u=s[c+3];e&&(u=0==(128&u)?0:255),0==u&&(h=l=d=0),r[a+c]=h,r[a+c+1]=l,r[a+c+2]=d,r[a+c+3]=u}a+=o}return r.buffer}}(i,n(12))}).call(this,n(11))},function(t,e){var n,i,r=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(t){if(n===setTimeout)return setTimeout(t,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(t){n=a}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}}();var c,h=[],l=!1,d=-1;function u(){l&&c&&(l=!1,c.length?h=c.concat(h):d=-1,h.length&&f())}function f(){if(!l){var t=o(u);l=!0;for(var e=h.length;e;){for(c=h,h=[];++d<e;)c&&c[d].run();d=-1,e=h.length}c=null,l=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new p(t,e)),1!==h.length||l||o(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,n){"use strict";var i={};(0,n(0).assign)(i,n(13),n(16),n(8)),t.exports=i},function(t,e,n){"use strict";var i=n(14),r=n(0),a=n(6),s=n(1),o=n(7),c=Object.prototype.toString,h=0,l=-1,d=0,u=8;function f(t){if(!(this instanceof f))return new f(t);this.options=r.assign({level:l,method:u,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var n=i.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(n!==h)throw new Error(s[n]);if(e.header&&i.deflateSetHeader(this.strm,e.header),e.dictionary){var p;if(p="string"==typeof e.dictionary?a.string2buf(e.dictionary):"[object ArrayBuffer]"===c.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(n=i.deflateSetDictionary(this.strm,p))!==h)throw new Error(s[n]);this._dict_set=!0}}function p(t,e){var n=new f(e);if(n.push(t,!0),n.err)throw n.msg||s[n.err];return n.result}f.prototype.push=function(t,e){var n,s,o=this.strm,l=this.options.chunkSize;if(this.ended)return!1;s=e===~~e?e:!0===e?4:0,"string"==typeof t?o.input=a.string2buf(t):"[object ArrayBuffer]"===c.call(t)?o.input=new Uint8Array(t):o.input=t,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new r.Buf8(l),o.next_out=0,o.avail_out=l),1!==(n=i.deflate(o,s))&&n!==h)return this.onEnd(n),this.ended=!0,!1;0!==o.avail_out&&(0!==o.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(a.buf2binstring(r.shrinkBuf(o.output,o.next_out))):this.onData(r.shrinkBuf(o.output,o.next_out)))}while((o.avail_in>0||0===o.avail_out)&&1!==n);return 4===s?(n=i.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===h):2!==s||(this.onEnd(h),o.avail_out=0,!0)},f.prototype.onData=function(t){this.chunks.push(t)},f.prototype.onEnd=function(t){t===h&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Deflate=f,e.deflate=p,e.deflateRaw=function(t,e){return(e=e||{}).raw=!0,p(t,e)},e.gzip=function(t,e){return(e=e||{}).gzip=!0,p(t,e)}},function(t,e,n){"use strict";var i,r=n(0),a=n(15),s=n(4),o=n(5),c=n(1),h=0,l=1,d=3,u=4,f=5,p=0,m=1,g=-2,v=-3,_=-5,b=-1,w=1,y=2,x=3,k=4,S=0,C=2,A=8,z=9,B=15,E=8,T=286,I=30,R=19,D=2*T+1,L=15,F=3,q=258,U=q+F+1,P=32,O=42,M=69,W=73,N=91,H=103,j=113,Z=666,V=1,G=2,Y=3,X=4,$=3;function K(t,e){return t.msg=c[e],e}function Q(t){return(t<<1)-(t>4?9:0)}function J(t){for(var e=t.length;--e>=0;)t[e]=0}function tt(t){var e=t.state,n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(r.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function et(t,e){a._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,tt(t.strm)}function nt(t,e){t.pending_buf[t.pending++]=e}function it(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function rt(t,e){var n,i,r=t.max_chain_length,a=t.strstart,s=t.prev_length,o=t.nice_match,c=t.strstart>t.w_size-U?t.strstart-(t.w_size-U):0,h=t.window,l=t.w_mask,d=t.prev,u=t.strstart+q,f=h[a+s-1],p=h[a+s];t.prev_length>=t.good_match&&(r>>=2),o>t.lookahead&&(o=t.lookahead);do{if(h[(n=e)+s]===p&&h[n+s-1]===f&&h[n]===h[a]&&h[++n]===h[a+1]){a+=2,n++;do{}while(h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&a<u);if(i=q-(u-a),a=u-q,i>s){if(t.match_start=e,s=i,i>=o)break;f=h[a+s-1],p=h[a+s]}}}while((e=d[e&l])>c&&0!=--r);return s<=t.lookahead?s:t.lookahead}function at(t){var e,n,i,a,c,h,l,d,u,f,p=t.w_size;do{if(a=t.window_size-t.lookahead-t.strstart,t.strstart>=p+(p-U)){r.arraySet(t.window,t.window,p,p,0),t.match_start-=p,t.strstart-=p,t.block_start-=p,e=n=t.hash_size;do{i=t.head[--e],t.head[e]=i>=p?i-p:0}while(--n);e=n=p;do{i=t.prev[--e],t.prev[e]=i>=p?i-p:0}while(--n);a+=p}if(0===t.strm.avail_in)break;if(h=t.strm,l=t.window,d=t.strstart+t.lookahead,u=a,f=void 0,(f=h.avail_in)>u&&(f=u),n=0===f?0:(h.avail_in-=f,r.arraySet(l,h.input,h.next_in,f,d),1===h.state.wrap?h.adler=s(h.adler,l,f,d):2===h.state.wrap&&(h.adler=o(h.adler,l,f,d)),h.next_in+=f,h.total_in+=f,f),t.lookahead+=n,t.lookahead+t.insert>=F)for(c=t.strstart-t.insert,t.ins_h=t.window[c],t.ins_h=(t.ins_h<<t.hash_shift^t.window[c+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[c+F-1])&t.hash_mask,t.prev[c&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=c,c++,t.insert--,!(t.lookahead+t.insert<F)););}while(t.lookahead<U&&0!==t.strm.avail_in)}function st(t,e){for(var n,i;;){if(t.lookahead<U){if(at(t),t.lookahead<U&&e===h)return V;if(0===t.lookahead)break}if(n=0,t.lookahead>=F&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+F-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-U&&(t.match_length=rt(t,n)),t.match_length>=F)if(i=a._tr_tally(t,t.strstart-t.match_start,t.match_length-F),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=F){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+F-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(et(t,!1),0===t.strm.avail_out))return V}return t.insert=t.strstart<F-1?t.strstart:F-1,e===u?(et(t,!0),0===t.strm.avail_out?Y:X):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?V:G}function ot(t,e){for(var n,i,r;;){if(t.lookahead<U){if(at(t),t.lookahead<U&&e===h)return V;if(0===t.lookahead)break}if(n=0,t.lookahead>=F&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+F-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=F-1,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-U&&(t.match_length=rt(t,n),t.match_length<=5&&(t.strategy===w||t.match_length===F&&t.strstart-t.match_start>4096)&&(t.match_length=F-1)),t.prev_length>=F&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-F,i=a._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-F),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+F-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=F-1,t.strstart++,i&&(et(t,!1),0===t.strm.avail_out))return V}else if(t.match_available){if((i=a._tr_tally(t,0,t.window[t.strstart-1]))&&et(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return V}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=a._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<F-1?t.strstart:F-1,e===u?(et(t,!0),0===t.strm.avail_out?Y:X):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?V:G}function ct(t,e,n,i,r){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=i,this.func=r}function ht(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=A,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*D),this.dyn_dtree=new r.Buf16(2*(2*I+1)),this.bl_tree=new r.Buf16(2*(2*R+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(L+1),this.heap=new r.Buf16(2*T+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*T+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function lt(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=C,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?O:j,t.adler=2===e.wrap?0:1,e.last_flush=h,a._tr_init(e),p):K(t,g)}function dt(t){var e,n=lt(t);return n===p&&((e=t.state).window_size=2*e.w_size,J(e.head),e.max_lazy_match=i[e.level].max_lazy,e.good_match=i[e.level].good_length,e.nice_match=i[e.level].nice_length,e.max_chain_length=i[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=F-1,e.match_available=0,e.ins_h=0),n}function ut(t,e,n,i,a,s){if(!t)return g;var o=1;if(e===b&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),a<1||a>z||n!==A||i<8||i>15||e<0||e>9||s<0||s>k)return K(t,g);8===i&&(i=9);var c=new ht;return t.state=c,c.strm=t,c.wrap=o,c.gzhead=null,c.w_bits=i,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=a+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+F-1)/F),c.window=new r.Buf8(2*c.w_size),c.head=new r.Buf16(c.hash_size),c.prev=new r.Buf16(c.w_size),c.lit_bufsize=1<<a+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new r.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=e,c.strategy=s,c.method=n,dt(t)}i=[new ct(0,0,0,0,function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(at(t),0===t.lookahead&&e===h)return V;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+n;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,et(t,!1),0===t.strm.avail_out))return V;if(t.strstart-t.block_start>=t.w_size-U&&(et(t,!1),0===t.strm.avail_out))return V}return t.insert=0,e===u?(et(t,!0),0===t.strm.avail_out?Y:X):(t.strstart>t.block_start&&(et(t,!1),t.strm.avail_out),V)}),new ct(4,4,8,4,st),new ct(4,5,16,8,st),new ct(4,6,32,32,st),new ct(4,4,16,16,ot),new ct(8,16,32,32,ot),new ct(8,16,128,128,ot),new ct(8,32,128,256,ot),new ct(32,128,258,1024,ot),new ct(32,258,258,4096,ot)],e.deflateInit=function(t,e){return ut(t,e,A,B,E,S)},e.deflateInit2=ut,e.deflateReset=dt,e.deflateResetKeep=lt,e.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?g:(t.state.gzhead=e,p):g},e.deflate=function(t,e){var n,r,s,c;if(!t||!t.state||e>f||e<0)return t?K(t,g):g;if(r=t.state,!t.output||!t.input&&0!==t.avail_in||r.status===Z&&e!==u)return K(t,0===t.avail_out?_:g);if(r.strm=t,n=r.last_flush,r.last_flush=e,r.status===O)if(2===r.wrap)t.adler=0,nt(r,31),nt(r,139),nt(r,8),r.gzhead?(nt(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),nt(r,255&r.gzhead.time),nt(r,r.gzhead.time>>8&255),nt(r,r.gzhead.time>>16&255),nt(r,r.gzhead.time>>24&255),nt(r,9===r.level?2:r.strategy>=y||r.level<2?4:0),nt(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(nt(r,255&r.gzhead.extra.length),nt(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=o(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=M):(nt(r,0),nt(r,0),nt(r,0),nt(r,0),nt(r,0),nt(r,9===r.level?2:r.strategy>=y||r.level<2?4:0),nt(r,$),r.status=j);else{var v=A+(r.w_bits-8<<4)<<8;v|=(r.strategy>=y||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(v|=P),v+=31-v%31,r.status=j,it(r,v),0!==r.strstart&&(it(r,t.adler>>>16),it(r,65535&t.adler)),t.adler=1}if(r.status===M)if(r.gzhead.extra){for(s=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),tt(t),s=r.pending,r.pending!==r.pending_buf_size));)nt(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=W)}else r.status=W;if(r.status===W)if(r.gzhead.name){s=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),tt(t),s=r.pending,r.pending===r.pending_buf_size)){c=1;break}c=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,nt(r,c)}while(0!==c);r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),0===c&&(r.gzindex=0,r.status=N)}else r.status=N;if(r.status===N)if(r.gzhead.comment){s=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),tt(t),s=r.pending,r.pending===r.pending_buf_size)){c=1;break}c=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,nt(r,c)}while(0!==c);r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),0===c&&(r.status=H)}else r.status=H;if(r.status===H&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&tt(t),r.pending+2<=r.pending_buf_size&&(nt(r,255&t.adler),nt(r,t.adler>>8&255),t.adler=0,r.status=j)):r.status=j),0!==r.pending){if(tt(t),0===t.avail_out)return r.last_flush=-1,p}else if(0===t.avail_in&&Q(e)<=Q(n)&&e!==u)return K(t,_);if(r.status===Z&&0!==t.avail_in)return K(t,_);if(0!==t.avail_in||0!==r.lookahead||e!==h&&r.status!==Z){var b=r.strategy===y?function(t,e){for(var n;;){if(0===t.lookahead&&(at(t),0===t.lookahead)){if(e===h)return V;break}if(t.match_length=0,n=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(et(t,!1),0===t.strm.avail_out))return V}return t.insert=0,e===u?(et(t,!0),0===t.strm.avail_out?Y:X):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?V:G}(r,e):r.strategy===x?function(t,e){for(var n,i,r,s,o=t.window;;){if(t.lookahead<=q){if(at(t),t.lookahead<=q&&e===h)return V;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=F&&t.strstart>0&&(i=o[r=t.strstart-1])===o[++r]&&i===o[++r]&&i===o[++r]){s=t.strstart+q;do{}while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<s);t.match_length=q-(s-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=F?(n=a._tr_tally(t,1,t.match_length-F),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(et(t,!1),0===t.strm.avail_out))return V}return t.insert=0,e===u?(et(t,!0),0===t.strm.avail_out?Y:X):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?V:G}(r,e):i[r.level].func(r,e);if(b!==Y&&b!==X||(r.status=Z),b===V||b===Y)return 0===t.avail_out&&(r.last_flush=-1),p;if(b===G&&(e===l?a._tr_align(r):e!==f&&(a._tr_stored_block(r,0,0,!1),e===d&&(J(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),tt(t),0===t.avail_out))return r.last_flush=-1,p}return e!==u?p:r.wrap<=0?m:(2===r.wrap?(nt(r,255&t.adler),nt(r,t.adler>>8&255),nt(r,t.adler>>16&255),nt(r,t.adler>>24&255),nt(r,255&t.total_in),nt(r,t.total_in>>8&255),nt(r,t.total_in>>16&255),nt(r,t.total_in>>24&255)):(it(r,t.adler>>>16),it(r,65535&t.adler)),tt(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?p:m)},e.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==O&&e!==M&&e!==W&&e!==N&&e!==H&&e!==j&&e!==Z?K(t,g):(t.state=null,e===j?K(t,v):p):g},e.deflateSetDictionary=function(t,e){var n,i,a,o,c,h,l,d,u=e.length;if(!t||!t.state)return g;if(2===(o=(n=t.state).wrap)||1===o&&n.status!==O||n.lookahead)return g;for(1===o&&(t.adler=s(t.adler,e,u,0)),n.wrap=0,u>=n.w_size&&(0===o&&(J(n.head),n.strstart=0,n.block_start=0,n.insert=0),d=new r.Buf8(n.w_size),r.arraySet(d,e,u-n.w_size,n.w_size,0),e=d,u=n.w_size),c=t.avail_in,h=t.next_in,l=t.input,t.avail_in=u,t.next_in=0,t.input=e,at(n);n.lookahead>=F;){i=n.strstart,a=n.lookahead-(F-1);do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+F-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++}while(--a);n.strstart=i,n.lookahead=F-1,at(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=F-1,n.match_available=0,t.next_in=h,t.input=l,t.avail_in=c,n.wrap=o,p},e.deflateInfo="pako deflate (from Nodeca project)"},function(t,e,n){"use strict";var i=n(0),r=4,a=0,s=1,o=2;function c(t){for(var e=t.length;--e>=0;)t[e]=0}var h=0,l=1,d=2,u=29,f=256,p=f+1+u,m=30,g=19,v=2*p+1,_=15,b=16,w=7,y=256,x=16,k=17,S=18,C=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],A=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],E=new Array(2*(p+2));c(E);var T=new Array(2*m);c(T);var I=new Array(512);c(I);var R=new Array(256);c(R);var D=new Array(u);c(D);var L,F,q,U=new Array(m);function P(t,e,n,i,r){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}function O(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function M(t){return t<256?I[t]:I[256+(t>>>7)]}function W(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function N(t,e,n){t.bi_valid>b-n?(t.bi_buf|=e<<t.bi_valid&65535,W(t,t.bi_buf),t.bi_buf=e>>b-t.bi_valid,t.bi_valid+=n-b):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function H(t,e,n){N(t,n[2*e],n[2*e+1])}function j(t,e){var n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1}function Z(t,e,n){var i,r,a=new Array(_+1),s=0;for(i=1;i<=_;i++)a[i]=s=s+n[i-1]<<1;for(r=0;r<=e;r++){var o=t[2*r+1];0!==o&&(t[2*r]=j(a[o]++,o))}}function V(t){var e;for(e=0;e<p;e++)t.dyn_ltree[2*e]=0;for(e=0;e<m;e++)t.dyn_dtree[2*e]=0;for(e=0;e<g;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*y]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function G(t){t.bi_valid>8?W(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function Y(t,e,n,i){var r=2*e,a=2*n;return t[r]<t[a]||t[r]===t[a]&&i[e]<=i[n]}function X(t,e,n){for(var i=t.heap[n],r=n<<1;r<=t.heap_len&&(r<t.heap_len&&Y(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!Y(e,i,t.heap[r],t.depth));)t.heap[n]=t.heap[r],n=r,r<<=1;t.heap[n]=i}function $(t,e,n){var i,r,a,s,o=0;if(0!==t.last_lit)do{i=t.pending_buf[t.d_buf+2*o]<<8|t.pending_buf[t.d_buf+2*o+1],r=t.pending_buf[t.l_buf+o],o++,0===i?H(t,r,e):(H(t,(a=R[r])+f+1,e),0!==(s=C[a])&&N(t,r-=D[a],s),H(t,a=M(--i),n),0!==(s=A[a])&&N(t,i-=U[a],s))}while(o<t.last_lit);H(t,y,e)}function K(t,e){var n,i,r,a=e.dyn_tree,s=e.stat_desc.static_tree,o=e.stat_desc.has_stree,c=e.stat_desc.elems,h=-1;for(t.heap_len=0,t.heap_max=v,n=0;n<c;n++)0!==a[2*n]?(t.heap[++t.heap_len]=h=n,t.depth[n]=0):a[2*n+1]=0;for(;t.heap_len<2;)a[2*(r=t.heap[++t.heap_len]=h<2?++h:0)]=1,t.depth[r]=0,t.opt_len--,o&&(t.static_len-=s[2*r+1]);for(e.max_code=h,n=t.heap_len>>1;n>=1;n--)X(t,a,n);r=c;do{n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],X(t,a,1),i=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=i,a[2*r]=a[2*n]+a[2*i],t.depth[r]=(t.depth[n]>=t.depth[i]?t.depth[n]:t.depth[i])+1,a[2*n+1]=a[2*i+1]=r,t.heap[1]=r++,X(t,a,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var n,i,r,a,s,o,c=e.dyn_tree,h=e.max_code,l=e.stat_desc.static_tree,d=e.stat_desc.has_stree,u=e.stat_desc.extra_bits,f=e.stat_desc.extra_base,p=e.stat_desc.max_length,m=0;for(a=0;a<=_;a++)t.bl_count[a]=0;for(c[2*t.heap[t.heap_max]+1]=0,n=t.heap_max+1;n<v;n++)(a=c[2*c[2*(i=t.heap[n])+1]+1]+1)>p&&(a=p,m++),c[2*i+1]=a,i>h||(t.bl_count[a]++,s=0,i>=f&&(s=u[i-f]),o=c[2*i],t.opt_len+=o*(a+s),d&&(t.static_len+=o*(l[2*i+1]+s)));if(0!==m){do{for(a=p-1;0===t.bl_count[a];)a--;t.bl_count[a]--,t.bl_count[a+1]+=2,t.bl_count[p]--,m-=2}while(m>0);for(a=p;0!==a;a--)for(i=t.bl_count[a];0!==i;)(r=t.heap[--n])>h||(c[2*r+1]!==a&&(t.opt_len+=(a-c[2*r+1])*c[2*r],c[2*r+1]=a),i--)}}(t,e),Z(a,h,t.bl_count)}function Q(t,e,n){var i,r,a=-1,s=e[1],o=0,c=7,h=4;for(0===s&&(c=138,h=3),e[2*(n+1)+1]=65535,i=0;i<=n;i++)r=s,s=e[2*(i+1)+1],++o<c&&r===s||(o<h?t.bl_tree[2*r]+=o:0!==r?(r!==a&&t.bl_tree[2*r]++,t.bl_tree[2*x]++):o<=10?t.bl_tree[2*k]++:t.bl_tree[2*S]++,o=0,a=r,0===s?(c=138,h=3):r===s?(c=6,h=3):(c=7,h=4))}function J(t,e,n){var i,r,a=-1,s=e[1],o=0,c=7,h=4;for(0===s&&(c=138,h=3),i=0;i<=n;i++)if(r=s,s=e[2*(i+1)+1],!(++o<c&&r===s)){if(o<h)do{H(t,r,t.bl_tree)}while(0!=--o);else 0!==r?(r!==a&&(H(t,r,t.bl_tree),o--),H(t,x,t.bl_tree),N(t,o-3,2)):o<=10?(H(t,k,t.bl_tree),N(t,o-3,3)):(H(t,S,t.bl_tree),N(t,o-11,7));o=0,a=r,0===s?(c=138,h=3):r===s?(c=6,h=3):(c=7,h=4)}}c(U);var tt=!1;function et(t,e,n,r){N(t,(h<<1)+(r?1:0),3),function(t,e,n,r){G(t),r&&(W(t,n),W(t,~n)),i.arraySet(t.pending_buf,t.window,e,n,t.pending),t.pending+=n}(t,e,n,!0)}e._tr_init=function(t){tt||(!function(){var t,e,n,i,r,a=new Array(_+1);for(n=0,i=0;i<u-1;i++)for(D[i]=n,t=0;t<1<<C[i];t++)R[n++]=i;for(R[n-1]=i,r=0,i=0;i<16;i++)for(U[i]=r,t=0;t<1<<A[i];t++)I[r++]=i;for(r>>=7;i<m;i++)for(U[i]=r<<7,t=0;t<1<<A[i]-7;t++)I[256+r++]=i;for(e=0;e<=_;e++)a[e]=0;for(t=0;t<=143;)E[2*t+1]=8,t++,a[8]++;for(;t<=255;)E[2*t+1]=9,t++,a[9]++;for(;t<=279;)E[2*t+1]=7,t++,a[7]++;for(;t<=287;)E[2*t+1]=8,t++,a[8]++;for(Z(E,p+1,a),t=0;t<m;t++)T[2*t+1]=5,T[2*t]=j(t,5);L=new P(E,C,f+1,p,_),F=new P(T,A,0,m,_),q=new P(new Array(0),z,0,g,w)}(),tt=!0),t.l_desc=new O(t.dyn_ltree,L),t.d_desc=new O(t.dyn_dtree,F),t.bl_desc=new O(t.bl_tree,q),t.bi_buf=0,t.bi_valid=0,V(t)},e._tr_stored_block=et,e._tr_flush_block=function(t,e,n,i){var c,h,u=0;t.level>0?(t.strm.data_type===o&&(t.strm.data_type=function(t){var e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return a;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return s;for(e=32;e<f;e++)if(0!==t.dyn_ltree[2*e])return s;return a}(t)),K(t,t.l_desc),K(t,t.d_desc),u=function(t){var e;for(Q(t,t.dyn_ltree,t.l_desc.max_code),Q(t,t.dyn_dtree,t.d_desc.max_code),K(t,t.bl_desc),e=g-1;e>=3&&0===t.bl_tree[2*B[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),c=t.opt_len+3+7>>>3,(h=t.static_len+3+7>>>3)<=c&&(c=h)):c=h=n+5,n+4<=c&&-1!==e?et(t,e,n,i):t.strategy===r||h===c?(N(t,(l<<1)+(i?1:0),3),$(t,E,T)):(N(t,(d<<1)+(i?1:0),3),function(t,e,n,i){var r;for(N(t,e-257,5),N(t,n-1,5),N(t,i-4,4),r=0;r<i;r++)N(t,t.bl_tree[2*B[r]+1],3);J(t,t.dyn_ltree,e-1),J(t,t.dyn_dtree,n-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,u+1),$(t,t.dyn_ltree,t.dyn_dtree)),V(t),i&&G(t)},e._tr_tally=function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(R[n]+f+1)]++,t.dyn_dtree[2*M(e)]++),t.last_lit===t.lit_bufsize-1},e._tr_align=function(t){N(t,l<<1,3),H(t,y,E),function(t){16===t.bi_valid?(W(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},function(t,e,n){"use strict";var i=n(17),r=n(0),a=n(6),s=n(8),o=n(1),c=n(7),h=n(20),l=Object.prototype.toString;function d(t){if(!(this instanceof d))return new d(t);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var n=i.inflateInit2(this.strm,e.windowBits);if(n!==s.Z_OK)throw new Error(o[n]);if(this.header=new h,i.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=a.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=i.inflateSetDictionary(this.strm,e.dictionary))!==s.Z_OK))throw new Error(o[n])}function u(t,e){var n=new d(e);if(n.push(t,!0),n.err)throw n.msg||o[n.err];return n.result}d.prototype.push=function(t,e){var n,o,c,h,d,u=this.strm,f=this.options.chunkSize,p=this.options.dictionary,m=!1;if(this.ended)return!1;o=e===~~e?e:!0===e?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof t?u.input=a.binstring2buf(t):"[object ArrayBuffer]"===l.call(t)?u.input=new Uint8Array(t):u.input=t,u.next_in=0,u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new r.Buf8(f),u.next_out=0,u.avail_out=f),(n=i.inflate(u,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&p&&(n=i.inflateSetDictionary(this.strm,p)),n===s.Z_BUF_ERROR&&!0===m&&(n=s.Z_OK,m=!1),n!==s.Z_STREAM_END&&n!==s.Z_OK)return this.onEnd(n),this.ended=!0,!1;u.next_out&&(0!==u.avail_out&&n!==s.Z_STREAM_END&&(0!==u.avail_in||o!==s.Z_FINISH&&o!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(c=a.utf8border(u.output,u.next_out),h=u.next_out-c,d=a.buf2string(u.output,c),u.next_out=h,u.avail_out=f-h,h&&r.arraySet(u.output,u.output,c,h,0),this.onData(d)):this.onData(r.shrinkBuf(u.output,u.next_out)))),0===u.avail_in&&0===u.avail_out&&(m=!0)}while((u.avail_in>0||0===u.avail_out)&&n!==s.Z_STREAM_END);return n===s.Z_STREAM_END&&(o=s.Z_FINISH),o===s.Z_FINISH?(n=i.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===s.Z_OK):o!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),u.avail_out=0,!0)},d.prototype.onData=function(t){this.chunks.push(t)},d.prototype.onEnd=function(t){t===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Inflate=d,e.inflate=u,e.inflateRaw=function(t,e){return(e=e||{}).raw=!0,u(t,e)},e.ungzip=u},function(t,e,n){"use strict";var i=n(0),r=n(4),a=n(5),s=n(18),o=n(19),c=0,h=1,l=2,d=4,u=5,f=6,p=0,m=1,g=2,v=-2,_=-3,b=-4,w=-5,y=8,x=1,k=2,S=3,C=4,A=5,z=6,B=7,E=8,T=9,I=10,R=11,D=12,L=13,F=14,q=15,U=16,P=17,O=18,M=19,W=20,N=21,H=22,j=23,Z=24,V=25,G=26,Y=27,X=28,$=29,K=30,Q=31,J=32,tt=852,et=592,nt=15;function it(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function rt(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function at(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=x,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new i.Buf32(tt),e.distcode=e.distdyn=new i.Buf32(et),e.sane=1,e.back=-1,p):v}function st(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,at(t)):v}function ot(t,e){var n,i;return t&&t.state?(i=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?v:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,st(t))):v}function ct(t,e){var n,i;return t?(i=new rt,t.state=i,i.window=null,(n=ot(t,e))!==p&&(t.state=null),n):v}var ht,lt,dt=!0;function ut(t){if(dt){var e;for(ht=new i.Buf32(512),lt=new i.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(o(h,t.lens,0,288,ht,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;o(l,t.lens,0,32,lt,0,t.work,{bits:5}),dt=!1}t.lencode=ht,t.lenbits=9,t.distcode=lt,t.distbits=5}function ft(t,e,n,r){var a,s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new i.Buf8(s.wsize)),r>=s.wsize?(i.arraySet(s.window,e,n-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((a=s.wsize-s.wnext)>r&&(a=r),i.arraySet(s.window,e,n-r,a,s.wnext),(r-=a)?(i.arraySet(s.window,e,n-r,r,0),s.wnext=r,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0}e.inflateReset=st,e.inflateReset2=ot,e.inflateResetKeep=at,e.inflateInit=function(t){return ct(t,nt)},e.inflateInit2=ct,e.inflate=function(t,e){var n,tt,et,nt,rt,at,st,ot,ct,ht,lt,dt,pt,mt,gt,vt,_t,bt,wt,yt,xt,kt,St,Ct,At=0,zt=new i.Buf8(4),Bt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return v;(n=t.state).mode===D&&(n.mode=L),rt=t.next_out,et=t.output,st=t.avail_out,nt=t.next_in,tt=t.input,at=t.avail_in,ot=n.hold,ct=n.bits,ht=at,lt=st,kt=p;t:for(;;)switch(n.mode){case x:if(0===n.wrap){n.mode=L;break}for(;ct<16;){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}if(2&n.wrap&&35615===ot){n.check=0,zt[0]=255&ot,zt[1]=ot>>>8&255,n.check=a(n.check,zt,2,0),ot=0,ct=0,n.mode=k;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&ot)<<8)+(ot>>8))%31){t.msg="incorrect header check",n.mode=K;break}if((15&ot)!==y){t.msg="unknown compression method",n.mode=K;break}if(ct-=4,xt=8+(15&(ot>>>=4)),0===n.wbits)n.wbits=xt;else if(xt>n.wbits){t.msg="invalid window size",n.mode=K;break}n.dmax=1<<xt,t.adler=n.check=1,n.mode=512&ot?I:D,ot=0,ct=0;break;case k:for(;ct<16;){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}if(n.flags=ot,(255&n.flags)!==y){t.msg="unknown compression method",n.mode=K;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=K;break}n.head&&(n.head.text=ot>>8&1),512&n.flags&&(zt[0]=255&ot,zt[1]=ot>>>8&255,n.check=a(n.check,zt,2,0)),ot=0,ct=0,n.mode=S;case S:for(;ct<32;){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}n.head&&(n.head.time=ot),512&n.flags&&(zt[0]=255&ot,zt[1]=ot>>>8&255,zt[2]=ot>>>16&255,zt[3]=ot>>>24&255,n.check=a(n.check,zt,4,0)),ot=0,ct=0,n.mode=C;case C:for(;ct<16;){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}n.head&&(n.head.xflags=255&ot,n.head.os=ot>>8),512&n.flags&&(zt[0]=255&ot,zt[1]=ot>>>8&255,n.check=a(n.check,zt,2,0)),ot=0,ct=0,n.mode=A;case A:if(1024&n.flags){for(;ct<16;){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}n.length=ot,n.head&&(n.head.extra_len=ot),512&n.flags&&(zt[0]=255&ot,zt[1]=ot>>>8&255,n.check=a(n.check,zt,2,0)),ot=0,ct=0}else n.head&&(n.head.extra=null);n.mode=z;case z:if(1024&n.flags&&((dt=n.length)>at&&(dt=at),dt&&(n.head&&(xt=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,tt,nt,dt,xt)),512&n.flags&&(n.check=a(n.check,tt,dt,nt)),at-=dt,nt+=dt,n.length-=dt),n.length))break t;n.length=0,n.mode=B;case B:if(2048&n.flags){if(0===at)break t;dt=0;do{xt=tt[nt+dt++],n.head&&xt&&n.length<65536&&(n.head.name+=String.fromCharCode(xt))}while(xt&&dt<at);if(512&n.flags&&(n.check=a(n.check,tt,dt,nt)),at-=dt,nt+=dt,xt)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=E;case E:if(4096&n.flags){if(0===at)break t;dt=0;do{xt=tt[nt+dt++],n.head&&xt&&n.length<65536&&(n.head.comment+=String.fromCharCode(xt))}while(xt&&dt<at);if(512&n.flags&&(n.check=a(n.check,tt,dt,nt)),at-=dt,nt+=dt,xt)break t}else n.head&&(n.head.comment=null);n.mode=T;case T:if(512&n.flags){for(;ct<16;){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}if(ot!==(65535&n.check)){t.msg="header crc mismatch",n.mode=K;break}ot=0,ct=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=D;break;case I:for(;ct<32;){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}t.adler=n.check=it(ot),ot=0,ct=0,n.mode=R;case R:if(0===n.havedict)return t.next_out=rt,t.avail_out=st,t.next_in=nt,t.avail_in=at,n.hold=ot,n.bits=ct,g;t.adler=n.check=1,n.mode=D;case D:if(e===u||e===f)break t;case L:if(n.last){ot>>>=7&ct,ct-=7&ct,n.mode=Y;break}for(;ct<3;){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}switch(n.last=1&ot,ct-=1,3&(ot>>>=1)){case 0:n.mode=F;break;case 1:if(ut(n),n.mode=W,e===f){ot>>>=2,ct-=2;break t}break;case 2:n.mode=P;break;case 3:t.msg="invalid block type",n.mode=K}ot>>>=2,ct-=2;break;case F:for(ot>>>=7&ct,ct-=7&ct;ct<32;){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}if((65535&ot)!=(ot>>>16^65535)){t.msg="invalid stored block lengths",n.mode=K;break}if(n.length=65535&ot,ot=0,ct=0,n.mode=q,e===f)break t;case q:n.mode=U;case U:if(dt=n.length){if(dt>at&&(dt=at),dt>st&&(dt=st),0===dt)break t;i.arraySet(et,tt,nt,dt,rt),at-=dt,nt+=dt,st-=dt,rt+=dt,n.length-=dt;break}n.mode=D;break;case P:for(;ct<14;){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}if(n.nlen=257+(31&ot),ot>>>=5,ct-=5,n.ndist=1+(31&ot),ot>>>=5,ct-=5,n.ncode=4+(15&ot),ot>>>=4,ct-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=K;break}n.have=0,n.mode=O;case O:for(;n.have<n.ncode;){for(;ct<3;){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}n.lens[Bt[n.have++]]=7&ot,ot>>>=3,ct-=3}for(;n.have<19;)n.lens[Bt[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,St={bits:n.lenbits},kt=o(c,n.lens,0,19,n.lencode,0,n.work,St),n.lenbits=St.bits,kt){t.msg="invalid code lengths set",n.mode=K;break}n.have=0,n.mode=M;case M:for(;n.have<n.nlen+n.ndist;){for(;vt=(At=n.lencode[ot&(1<<n.lenbits)-1])>>>16&255,_t=65535&At,!((gt=At>>>24)<=ct);){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}if(_t<16)ot>>>=gt,ct-=gt,n.lens[n.have++]=_t;else{if(16===_t){for(Ct=gt+2;ct<Ct;){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}if(ot>>>=gt,ct-=gt,0===n.have){t.msg="invalid bit length repeat",n.mode=K;break}xt=n.lens[n.have-1],dt=3+(3&ot),ot>>>=2,ct-=2}else if(17===_t){for(Ct=gt+3;ct<Ct;){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}ct-=gt,xt=0,dt=3+(7&(ot>>>=gt)),ot>>>=3,ct-=3}else{for(Ct=gt+7;ct<Ct;){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}ct-=gt,xt=0,dt=11+(127&(ot>>>=gt)),ot>>>=7,ct-=7}if(n.have+dt>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=K;break}for(;dt--;)n.lens[n.have++]=xt}}if(n.mode===K)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=K;break}if(n.lenbits=9,St={bits:n.lenbits},kt=o(h,n.lens,0,n.nlen,n.lencode,0,n.work,St),n.lenbits=St.bits,kt){t.msg="invalid literal/lengths set",n.mode=K;break}if(n.distbits=6,n.distcode=n.distdyn,St={bits:n.distbits},kt=o(l,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,St),n.distbits=St.bits,kt){t.msg="invalid distances set",n.mode=K;break}if(n.mode=W,e===f)break t;case W:n.mode=N;case N:if(at>=6&&st>=258){t.next_out=rt,t.avail_out=st,t.next_in=nt,t.avail_in=at,n.hold=ot,n.bits=ct,s(t,lt),rt=t.next_out,et=t.output,st=t.avail_out,nt=t.next_in,tt=t.input,at=t.avail_in,ot=n.hold,ct=n.bits,n.mode===D&&(n.back=-1);break}for(n.back=0;vt=(At=n.lencode[ot&(1<<n.lenbits)-1])>>>16&255,_t=65535&At,!((gt=At>>>24)<=ct);){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}if(vt&&0==(240&vt)){for(bt=gt,wt=vt,yt=_t;vt=(At=n.lencode[yt+((ot&(1<<bt+wt)-1)>>bt)])>>>16&255,_t=65535&At,!(bt+(gt=At>>>24)<=ct);){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}ot>>>=bt,ct-=bt,n.back+=bt}if(ot>>>=gt,ct-=gt,n.back+=gt,n.length=_t,0===vt){n.mode=G;break}if(32&vt){n.back=-1,n.mode=D;break}if(64&vt){t.msg="invalid literal/length code",n.mode=K;break}n.extra=15&vt,n.mode=H;case H:if(n.extra){for(Ct=n.extra;ct<Ct;){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}n.length+=ot&(1<<n.extra)-1,ot>>>=n.extra,ct-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=j;case j:for(;vt=(At=n.distcode[ot&(1<<n.distbits)-1])>>>16&255,_t=65535&At,!((gt=At>>>24)<=ct);){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}if(0==(240&vt)){for(bt=gt,wt=vt,yt=_t;vt=(At=n.distcode[yt+((ot&(1<<bt+wt)-1)>>bt)])>>>16&255,_t=65535&At,!(bt+(gt=At>>>24)<=ct);){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}ot>>>=bt,ct-=bt,n.back+=bt}if(ot>>>=gt,ct-=gt,n.back+=gt,64&vt){t.msg="invalid distance code",n.mode=K;break}n.offset=_t,n.extra=15&vt,n.mode=Z;case Z:if(n.extra){for(Ct=n.extra;ct<Ct;){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}n.offset+=ot&(1<<n.extra)-1,ot>>>=n.extra,ct-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=K;break}n.mode=V;case V:if(0===st)break t;if(dt=lt-st,n.offset>dt){if((dt=n.offset-dt)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=K;break}dt>n.wnext?(dt-=n.wnext,pt=n.wsize-dt):pt=n.wnext-dt,dt>n.length&&(dt=n.length),mt=n.window}else mt=et,pt=rt-n.offset,dt=n.length;dt>st&&(dt=st),st-=dt,n.length-=dt;do{et[rt++]=mt[pt++]}while(--dt);0===n.length&&(n.mode=N);break;case G:if(0===st)break t;et[rt++]=n.length,st--,n.mode=N;break;case Y:if(n.wrap){for(;ct<32;){if(0===at)break t;at--,ot|=tt[nt++]<<ct,ct+=8}if(lt-=st,t.total_out+=lt,n.total+=lt,lt&&(t.adler=n.check=n.flags?a(n.check,et,lt,rt-lt):r(n.check,et,lt,rt-lt)),lt=st,(n.flags?ot:it(ot))!==n.check){t.msg="incorrect data check",n.mode=K;break}ot=0,ct=0}n.mode=X;case X:if(n.wrap&&n.flags){for(;ct<32;){if(0===at)break t;at--,ot+=tt[nt++]<<ct,ct+=8}if(ot!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=K;break}ot=0,ct=0}n.mode=$;case $:kt=m;break t;case K:kt=_;break t;case Q:return b;case J:default:return v}return t.next_out=rt,t.avail_out=st,t.next_in=nt,t.avail_in=at,n.hold=ot,n.bits=ct,(n.wsize||lt!==t.avail_out&&n.mode<K&&(n.mode<Y||e!==d))&&ft(t,t.output,t.next_out,lt-t.avail_out)?(n.mode=Q,b):(ht-=t.avail_in,lt-=t.avail_out,t.total_in+=ht,t.total_out+=lt,n.total+=lt,n.wrap&&lt&&(t.adler=n.check=n.flags?a(n.check,et,lt,t.next_out-lt):r(n.check,et,lt,t.next_out-lt)),t.data_type=n.bits+(n.last?64:0)+(n.mode===D?128:0)+(n.mode===W||n.mode===q?256:0),(0===ht&&0===lt||e===d)&&kt===p&&(kt=w),kt)},e.inflateEnd=function(t){if(!t||!t.state)return v;var e=t.state;return e.window&&(e.window=null),t.state=null,p},e.inflateGetHeader=function(t,e){var n;return t&&t.state?0==(2&(n=t.state).wrap)?v:(n.head=e,e.done=!1,p):v},e.inflateSetDictionary=function(t,e){var n,i=e.length;return t&&t.state?0!==(n=t.state).wrap&&n.mode!==R?v:n.mode===R&&r(1,e,i,0)!==n.check?_:ft(t,e,i,i)?(n.mode=Q,b):(n.havedict=1,p):v},e.inflateInfo="pako inflate (from Nodeca project)"},function(t,e,n){"use strict";t.exports=function(t,e){var n,i,r,a,s,o,c,h,l,d,u,f,p,m,g,v,_,b,w,y,x,k,S,C,A;n=t.state,i=t.next_in,C=t.input,r=i+(t.avail_in-5),a=t.next_out,A=t.output,s=a-(e-t.avail_out),o=a+(t.avail_out-257),c=n.dmax,h=n.wsize,l=n.whave,d=n.wnext,u=n.window,f=n.hold,p=n.bits,m=n.lencode,g=n.distcode,v=(1<<n.lenbits)-1,_=(1<<n.distbits)-1;t:do{p<15&&(f+=C[i++]<<p,p+=8,f+=C[i++]<<p,p+=8),b=m[f&v];e:for(;;){if(f>>>=w=b>>>24,p-=w,0===(w=b>>>16&255))A[a++]=65535&b;else{if(!(16&w)){if(0==(64&w)){b=m[(65535&b)+(f&(1<<w)-1)];continue e}if(32&w){n.mode=12;break t}t.msg="invalid literal/length code",n.mode=30;break t}y=65535&b,(w&=15)&&(p<w&&(f+=C[i++]<<p,p+=8),y+=f&(1<<w)-1,f>>>=w,p-=w),p<15&&(f+=C[i++]<<p,p+=8,f+=C[i++]<<p,p+=8),b=g[f&_];n:for(;;){if(f>>>=w=b>>>24,p-=w,!(16&(w=b>>>16&255))){if(0==(64&w)){b=g[(65535&b)+(f&(1<<w)-1)];continue n}t.msg="invalid distance code",n.mode=30;break t}if(x=65535&b,p<(w&=15)&&(f+=C[i++]<<p,(p+=8)<w&&(f+=C[i++]<<p,p+=8)),(x+=f&(1<<w)-1)>c){t.msg="invalid distance too far back",n.mode=30;break t}if(f>>>=w,p-=w,x>(w=a-s)){if((w=x-w)>l&&n.sane){t.msg="invalid distance too far back",n.mode=30;break t}if(k=0,S=u,0===d){if(k+=h-w,w<y){y-=w;do{A[a++]=u[k++]}while(--w);k=a-x,S=A}}else if(d<w){if(k+=h+d-w,(w-=d)<y){y-=w;do{A[a++]=u[k++]}while(--w);if(k=0,d<y){y-=w=d;do{A[a++]=u[k++]}while(--w);k=a-x,S=A}}}else if(k+=d-w,w<y){y-=w;do{A[a++]=u[k++]}while(--w);k=a-x,S=A}for(;y>2;)A[a++]=S[k++],A[a++]=S[k++],A[a++]=S[k++],y-=3;y&&(A[a++]=S[k++],y>1&&(A[a++]=S[k++]))}else{k=a-x;do{A[a++]=A[k++],A[a++]=A[k++],A[a++]=A[k++],y-=3}while(y>2);y&&(A[a++]=A[k++],y>1&&(A[a++]=A[k++]))}break}}break}}while(i<r&&a<o);i-=y=p>>3,f&=(1<<(p-=y<<3))-1,t.next_in=i,t.next_out=a,t.avail_in=i<r?r-i+5:5-(i-r),t.avail_out=a<o?o-a+257:257-(a-o),n.hold=f,n.bits=p}},function(t,e,n){"use strict";var i=n(0),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,n,c,h,l,d,u){var f,p,m,g,v,_,b,w,y,x=u.bits,k=0,S=0,C=0,A=0,z=0,B=0,E=0,T=0,I=0,R=0,D=null,L=0,F=new i.Buf16(16),q=new i.Buf16(16),U=null,P=0;for(k=0;k<=15;k++)F[k]=0;for(S=0;S<c;S++)F[e[n+S]]++;for(z=x,A=15;A>=1&&0===F[A];A--);if(z>A&&(z=A),0===A)return h[l++]=20971520,h[l++]=20971520,u.bits=1,0;for(C=1;C<A&&0===F[C];C++);for(z<C&&(z=C),T=1,k=1;k<=15;k++)if(T<<=1,(T-=F[k])<0)return-1;if(T>0&&(0===t||1!==A))return-1;for(q[1]=0,k=1;k<15;k++)q[k+1]=q[k]+F[k];for(S=0;S<c;S++)0!==e[n+S]&&(d[q[e[n+S]]++]=S);if(0===t?(D=U=d,_=19):1===t?(D=r,L-=257,U=a,P-=257,_=256):(D=s,U=o,_=-1),R=0,S=0,k=C,v=l,B=z,E=0,m=-1,g=(I=1<<z)-1,1===t&&I>852||2===t&&I>592)return 1;for(;;){b=k-E,d[S]<_?(w=0,y=d[S]):d[S]>_?(w=U[P+d[S]],y=D[L+d[S]]):(w=96,y=0),f=1<<k-E,C=p=1<<B;do{h[v+(R>>E)+(p-=f)]=b<<24|w<<16|y|0}while(0!==p);for(f=1<<k-1;R&f;)f>>=1;if(0!==f?(R&=f-1,R+=f):R=0,S++,0==--F[k]){if(k===A)break;k=e[n+d[S]]}if(k>z&&(R&g)!==m){for(0===E&&(E=z),v+=C,T=1<<(B=k-E);B+E<A&&!((T-=F[B+E])<=0);)B++,T<<=1;if(I+=1<<B,1===t&&I>852||2===t&&I>592)return 1;h[m=R&g]=z<<24|B<<16|v-l|0}}return 0!==R&&(h[v+R]=k-E<<24|64<<16|0),u.bits=z,0}},function(t,e,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(t,e,n){var i=n(22);"string"==typeof i&&(i=[[t.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(3)(i,r);i.locals&&(t.exports=i.locals)},function(t,e,n){(t.exports=n(2)(!1)).push([t.i,'* {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\nhtml {\n  font-family: "Titillium Web", "Roboto", "Open Sans";\n  font-weight: 400;\n  font-size: 100%;\n}\n\na {\n  text-decoration: none;\n}\n\nli {\n  list-style-type: none;\n}\n\nbody {\n  background: rgba(93,93,93,.55);\n  user-select:none;\n}\n\ninput {\n  border: none;\n  background-image: none;\n  background-color: transparent;\n  -webkit-box-shadow: none;\n  -moz-box-shadow: none;\n  box-shadow: none;\n}\n\ninput:focus {\n  outline: none;\n}\n\n.preview__item img {\n  width: 2%;\n  top: 114px;\n  position: absolute;\n}\n\n#fullScreen {\n  display: none;\n}\n\n.row {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  width: 100%;\n}\n\n.column {\n  display: flex;\n  flex-direction: column;\n}\n\n.header {\n\tbox-shadow: 0 0 25px;\n\tpadding: 12px 20px 12px 30px;\n\tposition: relative;\n  background: #000;\n  margin-bottom: 20px;\n}\n.header\t.container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: unset;\n}\n.header\t.container\ta {\n  margin-right: 40px;\n}\n.header-item {\n  display: flex;\n  align-items: center;\n}\n.header-item-logo img  {\n  width: 100px;\n}\n.header-title {\n  font-family: \'Roboto-Medium\';\n  font-size: 20px;\n  color: gray;\n  width: 100%;\n  text-align: center;\n}\n\n.main {\n  margin: 5px auto;\n}\n\n.tools {\n  display: flex;\n  justify-content: center;\n}\n\n.tools__item img {\n  width: 50%;\n  filter: invert(1);\n}\n\n.tools__pen-size {\n  display: flex;\n  justify-content: space-around;\n  margin-top: 60px;\n}\n\n.tools__pen-size__item {\n  position: relative;\n  width: 20px;\n  height: 20px;\n  border: 2px solid;\n  border-color: #444;\n}\n\n.tools__pen-size__item:hover {\n  border-color: #888;\n  cursor: pointer;\n}\n\n.first-size-pen:before {\n  content: "";\n  position: absolute;\n  top: 5px;\n  left: 5px;\n  width: 6px;\n  height: 6px;\n  background-color: #fff;\n}\n\n.second-size-pen:before {\n  content: "";\n  position: absolute;\n  top: 4px;\n  left: 4px;\n  width: 8px;\n  height: 8px;\n  background-color: #fff;\n}\n\n.third-size-pen:before {\n  content: "";\n  position: absolute;\n  top: 3px;\n  left: 3px;\n  width: 10px;\n  height: 10px;\n  background-color: #fff;\n}\n\n.fourth-size-pen:before {\n  content: "";\n  position: absolute;\n  top: 2px;\n  left: 2px;\n  width: 12px;\n  height: 12px;\n  background-color: #fff;\n}\n\n.tools__wrapper {\n  margin: 5px auto;\n  width: 114px;\n}\n\n.tools__item {\n  margin: 1px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: 1px;\n  width: 55px;\n  height: 55px;\n  background: #4c4848;\n  border: 4px solid;\n  cursor: pointer;\n}\n\n.tools__item:hover {\n  border-color: #444;\n  background-color: #444;\n}\n\n.tools__item i {\n  font-size: 24px;\n  color: #fff;\n}\n\n.highlight {\n  border-color: #ffd700;\n}\n\n.highlight:hover {\n  border-color: #ffd700;\n}\n\n.highlight_tool {\n  border: 4px solid #ffd700;\n}\n\n.highlight_tool:hover {\n  border: 4px solid #ffd700;\n}\n\n.tools__item .out-of-order {\n  color: #888888;\n}\n\n#switch-colors {\n  width: 23%;\n  position: absolute;\n  top: 62px;\n  left: 6px;\n  filter: invert(1);\n}\n\n.canvas {\n  flex: 1;\n  background: rgba(93,93,93, 0);\n  border: 1px solid grey;\n}\n\n.canvas__background {\n  position: relative;\n  margin: auto auto;\n  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAV0lEQVRYCe2WMQ4AIAgD0bDwN/7/FUb9AR2Muhxr04QclDAyc1lTEdGoZlXV6so/W/cDkQYgAAFXOT3NufIzAghA4DsBVzm9fSe+E6ABCECAf4AdgAAENkFXF0Suev9HAAAAAElFTkSuQmCC)\n    repeat;\n}\n\n.canvas__item {\n  margin: 0 auto;\n  background: transparent;\n}\n\n.canvas__buffer {\n  position: absolute;\n  top: 0;\n  margin: auto;\n  background: transparent;\n}\n\n.preview {\n  display: flex;\n  justify-content: space-between;\n  width: 230px;\n}\n\n.preview__fps-wrapper {\n  margin: 0 auto;\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  background-color: rgb(51, 51, 51);\n  width: 200px;\n  height: 27px;\n}\n\n.preview__background {\n  margin: 0 auto;\n  width: 200px;\n  height: 200px;\n  align-self: center;\n  box-sizing: border-box;\n  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAV0lEQVRYCe2WMQ4AIAgD0bDwN/7/FUb9AR2Muhxr04QclDAyc1lTEdGoZlXV6so/W/cDkQYgAAFXOT3NufIzAghA4DsBVzm9fSe+E6ABCECAf4AdgAAENkFXF0Suev9HAAAAAElFTkSuQmCC)\n    repeat;\n}\n\n.preview__item {\n  display: flex;\n  justify-content: flex-end;\n  width: 200px;\n  height: 200px;\n  background-repeat: no-repeat;\n  background-position: center;\n  background-size: contain;\n}\n\n.preview__item i {\n  display: none;\n  margin: 7px 7px 0 0;\n  font-size: 22px;\n  color: #fff;\n  cursor: pointer;\n}\n\n.preview__fps-number {\n  color: rgb(170, 170, 170);\n  font-size: 14px;\n}\n\n.preview__data-wrapper {\n  display: flex;\n}\n\n.preview__data {\n  margin: 15px;\n  font-size: 13px;\n  color: #ffd700;\n}\n\n.preview__transform-wrapper {\n  margin: 10px 15px;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  flex-wrap: wrap;\n  background-color: #222222;\n  width: 155px;\n  height: 85px;\n  border: 2px solid #888888;\n}\n\n.transform__title {\n  padding-top: 5px;\n  width: 100%;\n  height: 32px;\n  text-align: center;\n  color: #fff;\n  font-weight: 700;\n}\n\n.transform__buttons-wrapper {\n  display: flex;\n  justify-content: space-between;\n  width: 100%;\n}\n\n.transform-button {\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 48px;\n  height: 48px;\n  color: #fff;\n  font-size: 32px;\n  transform: translate(0px, 0px);\n  transition:transform 0.3s ease;\n  border: 3px solid;\n  border-color: #3a3a3a;\n  background-color: #3a3a3a;\n  cursor: pointer;\n}\n\n.transform-button:hover {\n  border-color: #444;\n  background-color: #444;\n}\n\n.preview__item:fullscreen {\n  background-color: rgb(255, 255, 255);\n}\n.preview__item:-webkit-full-screen {\n  background-color: rgb(255, 255, 255);\n}\n.preview__item:-moz-full-screen {\n  background-color: rgb(255, 255, 255);\n}\n\n.features {\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: 608px;\n}\n\n.features__button {\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 48px;\n  height: 48px;\n  color: #fff;\n  font-size: 32px;\n  transform: translate(0px, 0px);\n  transition:transform 0.3s ease;\n  border: 3px solid;\n  border-color: #3a3a3a;\n  background-color: #3a3a3a;\n  cursor: pointer;\n}\n\n.features__button:hover {\n  border-color: #444;\n  background-color: #444;\n}\n\n.features__button:not(:first-child) {\n  margin-top: 10px;\n}\n\n.resize__info {\n  margin-top: 5px;\n  color: #fff;\n  font-size: 11px;\n}\n\n.download__button {\n  position: relative;\n  margin-top: 10px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 48px;\n  height: 48px;\n  color: #fff;\n  font-size: 19px;\n  transform: translate(0px, 0px);\n  transition:transform 0.3s ease;\n  border: 3px solid;\n  border-color: #3a3a3a;\n  background-color: #3a3a3a;\n  cursor: pointer;\n}\n\n.download__button:hover {\n  border-color: #444;\n  background-color: #444;\n}\n\n.apng__download {\n  font-size: 18px;\n}\n',""])},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,i=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var r,a=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?t:(r=0===a.indexOf("//")?a:0===a.indexOf("/")?n+a:i+a.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")})}},function(t,e,n){var i=n(25);"string"==typeof i&&(i=[[t.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(3)(i,r);i.locals&&(t.exports=i.locals)},function(t,e,n){(t.exports=n(2)(!1)).push([t.i,".tools__picker-container {\n  position: relative;\n}\n\n.tools__picker-item {\n  position: absolute;\n  width: 48px;\n  height: 48px;\n  background-color: rgb(68, 68, 68);\n  cursor: pointer;\n}\n\n.tools__picker-item:hover {\n  background-color: rgb(136, 136, 136);\n}\n\n.primary-color {\n  top: 5px;\n  left: 10px;\n}\n\n.secondary-color {\n  top: 35px;\n  left: 35px;\n}\n\n.fa-sync-alt {\n  position: absolute;\n  top: 60px;\n  left: 14px;\n  color: rgb(68, 68, 68);\n  cursor: pointer;\n}\n\n.fa-sync-alt:hover {\n  color: rgb(136, 136, 136);\n}\n",""])},function(t,e,n){var i=n(27);"string"==typeof i&&(i=[[t.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(3)(i,r);i.locals&&(t.exports=i.locals)},function(t,e,n){(t.exports=n(2)(!1)).push([t.i,".frames__wrapper {\n  margin-right: 6px;\n  display: flex;\n  flex-direction: column;\n  width: 140px;\n  color: #fff;\n  align-items: center;\n  height: 608px;\n  overflow-y: auto;\n}\n\n.frame__background {\n  margin: 0 auto 10px;\n  width: 100px;\n  height: 100px;\n  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAV0lEQVRYCe2WMQ4AIAgD0bDwN/7/FUb9AR2Muhxr04QclDAyc1lTEdGoZlXV6so/W/cDkQYgAAFXOT3NufIzAghA4DsBVzm9fSe+E6ABCECAf4AdgAAENkFXF0Suev9HAAAAAElFTkSuQmCC) repeat;\n}\n\n.frame__unit {\n  position: relative;\n  margin: 0 auto;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n  width: 100px;\n  height: 100px;\n  background-repeat: no-repeat;\n  background-position: center;\n  background-size: cover;\n  border: 2px solid;\n  border-color: rgb(68, 68, 68);\n  border-radius: none;\n}\n\n.frame__item-button {\n  display: none;\n  width: 21px;\n  height: 21px;\n  text-align: center;\n  line-height: 21px;\n  background-color: rgba(128, 128, 128, 0.5);\n  cursor: default;\n}\n\n.frame__item-button img {\n  width: 50%;\n  filter: invert(1);\n}\n\n.index {\n  position: absolute;\n  top: 0;\n  left: 0;\n  display: block;\n}\n\n.move-frame {\n  position: absolute;\n  top: 0;\n  right: 0;\n  cursor: move;\n}\n\n.move {\n  top: 50%;\n  margin-top: -4px;\n  left: 5px;\n}\n\n.frame__unit .index {\n  color: #000;\n  background-color: rgba(255, 215, 0);\n}\n\n.copy, .trash {\n  cursor: pointer;\n}\n\n.frames__add-frame-button {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin: 0 auto;\n  padding: 0 5px;\n  width: 100px;\n  height: 43px;\n  font-size: 14px;\n  vertical-align: middle;\n  background: #4c4848;\n  color: #fff;\n  line-height: 30px;\n  border: 1px solid;\n}\n\n.frames__add-frame-button:hover {\n  border-color: rgba(255, 215, 0);\n  cursor: pointer;\n}\n\n.frames__add-frame-button i {\n  color: #fff;\n  font-size: 21px;\n  padding-right: 10px;\n}\n\n.frames__wrapper::-webkit-scrollbar-track {\n  box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n  -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n  border-radius: 3px;\n  background-color: rgb(37, 37, 37);\n}\n\n.frames__wrapper::-webkit-scrollbar {\n  width: 7px;\n  background-color: transparent;\n}\n\n.frames__wrapper::-webkit-scrollbar-thumb {\n  border-radius: 10px;\n  box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n  -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n  background-color: rgb(102, 102, 102);\n}\n\n.resize__button img {\n  width: 70%;\n  filter: invert(1);\n}\n",""])},function(t,e,n){"use strict";n.r(e);class i{constructor(){this.switchColorButton=document.querySelector("#switch-colors"),this.primaryColor=document.querySelector("#primary-color"),this.secondaryColor=document.querySelector("#secondary-color")}switchColors(){const t=this.primaryColor.value;this.primaryColor.value=this.secondaryColor.value,this.secondaryColor.value=t}init(){this.switchColorButton.addEventListener("click",this.switchColors.bind(this))}}let r=0;const a=[];function s(t){r=t}class o{constructor(){this.canvas=document.querySelector(".canvas__item"),this.canvasHeight=this.canvas.height,this.frameWrapper=document.querySelector(".frames__wrapper")}showFramesButtons(t){let{target:e}=t;for(;e.className.indexOf("frames__wrapper")<0;){if(e.className.indexOf("frame__unit")>=0){this.hideAllFramesButtons(),[...e.children].map(t=>t.style.display="block")}e=e.parentElement}}hideFramesButtons(t){t.target.className.indexOf("frames__wrapper")>=0&&this.hideAllFramesButtons()}hideAllFramesButtons(){[...document.querySelectorAll(".hide-button")].map(t=>t.style.display="none")}init(){this.frameWrapper.style.height=this.canvasHeight,this.frameWrapper.addEventListener("mouseover",this.showFramesButtons.bind(this)),this.frameWrapper.addEventListener("mouseover",this.hideFramesButtons.bind(this)),this.frameWrapper.addEventListener("mouseleave",this.hideAllFramesButtons.bind(this))}}class c{static clone(t){if(t){const e=document.createElement("canvas"),n=e.getContext("2d");return e.setAttribute("class","canvas__item"),e.width=t.width,e.height=t.height,n.drawImage(t,0,0),e}return null}}let h;class l{static check(t){return t.target.parentElement.className.indexOf("frame__unit")>=0?s(t.target.parentElement.children[1].textContent):t.target.className.indexOf("frame__unit")>=0?s(t.target.children[1].textContent):s(t.target.parentElement.parentElement.children[1].textContent),r&&(h=r,h-=1),s(h),r}}class d{constructor(t){this.emptyFrame=t,this.frameWrapper=document.querySelector(".frames__wrapper"),this.addFrameButton=document.querySelector(".frames__add-frame-button")}init(t){const e=this.emptyFrame.cloneNode(!0);e.children[0].children[1].textContent=t,e.children[0].style.position="relative",e.children[0].style.zIndex="auto",e.children[0].style.top="auto",e.children[0].style.left="auto",this.frameWrapper.insertBefore(e,this.addFrameButton)}}let u=null;const f=[];class p{constructor(){this.fpsInput=document.querySelector("#fps"),this.previewBackground=document.querySelector(".preview__background"),this.fullScreenButton=document.querySelector("#fullScreen")}show(){f.length=0,clearInterval(u);const t=[...document.querySelectorAll(".frame__unit")];t.map(t=>{f.push(t.style.backgroundImage)});const e=document.querySelector(".preview__item");let n=100;if(0==+this.fpsInput.value)return e.style.backgroundImage=f[r],n=0;n=1e3/+this.fpsInput.value;let i=0;u=window.setInterval(()=>{e.style.backgroundImage=f[i],i>=t.length?i=0:i+=1},n)}showFPS(){document.querySelector("#show-fps").textContent=`${this.fpsInput.value} FPS`}showFullScreenButton(t){let{target:e}=t;for(;e.className.indexOf("preview__background")<0;){e.className.indexOf("preview__item")>=0&&(this.fullScreenButton.style.display="block"),e=e.parentElement}}hideFullScreenButton(t){t.target.className.indexOf("preview__background")>=0&&(this.fullScreenButton.style.display="none")}init(){this.fpsInput.addEventListener("input",this.show.bind(this)),this.fpsInput.addEventListener("input",this.showFPS.bind(this)),this.previewBackground.addEventListener("mouseover",this.showFullScreenButton.bind(this)),this.previewBackground.addEventListener("mouseleave",this.hideFullScreenButton.bind(this))}}class m{constructor(t){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.emptyDataURL=t,this.cloneCanvas=new c}setEmpty(){[...document.querySelectorAll(".frame__unit")][r].style.backgroundImage=`url('${this.emptyDataURL}')`}init(t,e){this.canvas=document.querySelector(".canvas__item");const n=[...document.querySelectorAll(".frame__unit")];if(a[r]=c.clone(this.canvas),e){n[n.length-1].style.backgroundImage=e}else{const t=this.canvas.toDataURL();n[r].style.backgroundImage=`url('${t}')`}this.previewTool=new p,this.previewTool.show()}}let g=0;const v=[32,64,128];class _{constructor(){this.resizeButton=document.querySelector(".resize__button"),this.resizeInfo=document.querySelector(".resize__info"),this.canvas=document.querySelector(".canvas__item"),this.canvasBackground=document.querySelector(".canvas__background"),this.previewTool=new p,this.emptyDataURL=this.canvas.toDataURL(),this.setFramePrev=new m(this.emptyDataURL),this.canvasBuffer=document.querySelector(".canvas__buffer")}changeSize(){this.canvas=document.querySelector(".canvas__item"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.canvasBackground=document.querySelector(".canvas__background"),this.ctx=this.canvas.getContext("2d"),(g+=1)>2&&(g=0);const t=this.canvas.parentElement.offsetHeight,e=Math.round(t/v[g])*v[g],n=document.createElement("canvas"),i=n.getContext("2d");n.width=`${e}`,n.height=`${e}`;const r=(e-this.canvas.width)/2;i.drawImage(this.canvas,r,r),this.canvas.width=`${e}`,this.canvas.height=`${e}`,this.canvasBuffer.width=`${e}`,this.canvasBuffer.height=`${e}`,this.canvasBackground.style.height=`${e}px`,this.resizeInfo.textContent=`${v[g]} / ${v[g]}`,this.ctx.drawImage(n,0,0),this.previewTool.show()}getCurrentPixelSize(){return this.canvas=document.querySelector(".canvas__item"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.canvas.parentElement.offsetHeight/v[g]}init(){this.resizeButton.addEventListener("click",this.changeSize.bind(this)),this.resizeButton.addEventListener("click",this.setFramePrev.init.bind(this))}}class b{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.color="#000",this.pixelSize=void 0,this.paint=!1,this.prevDot=[],this.currDot=[],this.primaryColor=document.querySelector("#primary-color"),this.secondaryColor=document.querySelector("#secondary-color"),this.resizeTool=new _,this.canvasBackground=document.querySelector(".canvas__background")}static canselDefaultRightClich(t){t.preventDefault()}getRightCoordinate(t,e){let n=t,i=e;return[n=Math.floor(n/this.pixelSize)*this.pixelSize,i=Math.floor(i/this.pixelSize)*this.pixelSize]}drawPixel(t,e){this.ctx.fillStyle=this.color,this.ctx.fillRect(t,e,this.pixelSize,this.pixelSize)}bresenhamAlgorithm(t,e,n,i){const r=this.getRightCoordinate(t,e),a=this.getRightCoordinate(n,i);let s=r[0],o=r[1];const c=a[0],h=a[1],l=Math.abs(c-s),d=Math.abs(h-o),u=s<c?this.pixelSize:-this.pixelSize,f=o<h?this.pixelSize:-this.pixelSize;let p=l-d;for(;s!==c||o!==i;){const t=2*p;t>-d&&(p-=d,s+=u),t<l&&(p+=l,o+=f),this.drawPixel(s,o)}}startDrawing(t){t.preventDefault(),this.canvas=document.querySelector(".canvas__item"),this.pixelSize=this.resizeTool.getCurrentPixelSize(),0===t.button?this.color=this.primaryColor.value:2===t.button&&(this.color=this.secondaryColor.value);const e=t.pageX-this.canvas.parentElement.offsetLeft,n=t.pageY-this.canvas.parentElement.offsetTop;this.paint=!0;const i=this.getRightCoordinate(e,n);this.drawPixel(i[0],i[1]),this.prevDot=[...i]}stopDrawing(){this.paint=!1}draw(t){if(this.paint){const e=t.pageX-this.canvas.parentElement.offsetLeft,n=t.pageY-this.canvas.parentElement.offsetTop;this.currDot=this.getRightCoordinate(e,n),this.bresenhamAlgorithm(...this.prevDot,...this.currDot),this.prevDot=this.currDot}}init(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBackground.addEventListener("mousedown",this.startDrawing.bind(this)),this.canvasBackground.addEventListener("mousemove",this.draw.bind(this)),this.canvasBackground.addEventListener("mouseup",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("mouseleave",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("contextmenu",b.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/pen.png') 0 16, auto"}}const w=[];class y{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.startR=0,this.startG=0,this.startB=0,this.startA=1,this.colorLayer=this.ctx.getImageData(0,0,this.canvasWidth,this.canvasHeight),this.primaryColor=document.querySelector("#primary-color"),this.secondaryColor=document.querySelector("#secondary-color"),this.targetColor=void 0,this.canvasBackground=document.querySelector(".canvas__background")}static canselDefaultRightClich(t){t.preventDefault()}hexToRgb(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}getStartPoint(t){const e=t.pageX-this.canvas.parentElement.offsetLeft,n=t.pageY-this.canvas.parentElement.offsetTop,i=this.ctx.getImageData(e,n,1,1);return this.startR=i.data[0],this.startG=i.data[1],this.startB=i.data[2],this.startA=i.data[3]/255,[e,n]}matchStartColor(t){const e=this.colorLayer.data[t],n=this.colorLayer.data[t+1],i=this.colorLayer.data[t+2];return e===this.startR&&n===this.startG&&i===this.startB}colorPixel(t){const e=this.hexToRgb(this.targetColor),n=e.r,i=e.g,r=e.b;this.colorLayer.data[t]=n,this.colorLayer.data[t+1]=i,this.colorLayer.data[t+2]=r,this.colorLayer.data[t+3]=255}paint(t){0===t.button?this.targetColor=this.primaryColor.value:2===t.button&&(this.targetColor=this.secondaryColor.value),this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.colorLayer=this.ctx.getImageData(0,0,this.canvasWidth,this.canvasHeight),w.push(this.getStartPoint(t));const e=this.hexToRgb(this.targetColor);if(e.r===this.startR&&e.g===this.startG&&e.b===this.startB)return!1;for(;w.length;){let t,e,n;const i=w.pop(),r=i[0];let a=i[1];for(t=4*(a*this.canvasWidth+r);a-- >=0&&this.matchStartColor(t);)t-=4*this.canvasWidth;for(t+=4*this.canvasWidth,++a,e=!1,n=!1;a++<this.canvasHeight-1&&this.matchStartColor(t);)this.colorPixel(t),r>0&&(this.matchStartColor(t-4)?e||(w.push([r-1,a]),e=!0):e&&(e=!1)),r<this.canvasWidth-1&&(this.matchStartColor(t+4)?n||(w.push([r+1,a]),n=!0):n&&(n=!1)),t+=4*this.canvasWidth}this.ctx.putImageData(this.colorLayer,0,0)}init(){this.canvas=document.querySelector(".canvas__item"),this.canvasBackground=document.querySelector(".canvas__background"),this.ctx=this.canvas.getContext("2d"),this.canvasBackground.addEventListener("mousedown",this.paint.bind(this)),this.canvasBackground.addEventListener("contextmenu",y.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/paint-bucket.png') 16 16, auto"}}class x{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.pixelSize=void 0,this.paint=!1,this.prevDot=[],this.currDot=[],this.resizeTool=new _,this.canvasBackground=document.querySelector(".canvas__background")}static canselDefaultRightClich(t){t.preventDefault()}getRightCoordinate(t,e){let n=t,i=e;return[n=Math.floor(n/this.pixelSize)*this.pixelSize,i=Math.floor(i/this.pixelSize)*this.pixelSize]}drawPixel(t,e){this.ctx.clearRect(t,e,this.pixelSize,this.pixelSize)}bresenhamAlgorithm(t,e,n,i){const r=this.getRightCoordinate(t,e),a=this.getRightCoordinate(n,i);let s=r[0],o=r[1];const c=a[0],h=a[1],l=Math.abs(c-s),d=Math.abs(h-o),u=s<c?this.pixelSize:-this.pixelSize,f=o<h?this.pixelSize:-this.pixelSize;let p=l-d;for(;s!==c||o!==i;){const t=2*p;t>-d&&(p-=d,s+=u),t<l&&(p+=l,o+=f),this.drawPixel(s,o)}}startDrawing(t){t.preventDefault(),this.pixelSize=this.resizeTool.getCurrentPixelSize();const e=t.pageX-this.canvas.parentElement.offsetLeft,n=t.pageY-this.canvas.parentElement.offsetTop;this.paint=!0;const i=this.getRightCoordinate(e,n);this.drawPixel(i[0],i[1]),this.prevDot=[...i]}stopDrawing(){this.paint=!1}draw(t){if(this.paint){const e=t.pageX-this.canvas.parentElement.offsetLeft,n=t.pageY-this.canvas.parentElement.offsetTop;this.currDot=this.getRightCoordinate(e,n),this.bresenhamAlgorithm(...this.prevDot,...this.currDot),this.prevDot=this.currDot}}init(){this.canvas=document.querySelector(".canvas__item"),this.canvasBackground=document.querySelector(".canvas__background"),this.ctx=this.canvas.getContext("2d"),this.canvasBackground.addEventListener("mousedown",this.startDrawing.bind(this)),this.canvasBackground.addEventListener("mousemove",this.draw.bind(this)),this.canvasBackground.addEventListener("mouseup",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("mouseleave",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("contextmenu",x.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/eraser.png') 0 16, auto"}}class k{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.color="#000",this.pixelSize=void 0,this.paint=!1,this.prevDot=[],this.currDot=[],this.primaryColor=document.querySelector("#primary-color"),this.secondaryColor=document.querySelector("#secondary-color"),this.resizeTool=new _,this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d")}static canselDefaultRightClich(t){t.preventDefault()}getRightCoordinate(t,e){let n=t,i=e;return[n=Math.floor(n/this.pixelSize)*this.pixelSize,i=Math.floor(i/this.pixelSize)*this.pixelSize]}drawPixel(t,e,n){n.fillStyle=this.color,n.fillRect(t,e,this.pixelSize,this.pixelSize)}startDrawing(t){t.preventDefault(),this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.pixelSize=this.resizeTool.getCurrentPixelSize(),0===t.button?this.color=this.primaryColor.value:2===t.button&&(this.color=this.secondaryColor.value);const e=t.pageX-this.canvasBuffer.parentElement.offsetLeft,n=t.pageY-this.canvasBuffer.parentElement.offsetTop;this.paint=!0;const i=this.getRightCoordinate(e,n);this.drawPixel(i[0],i[1],this.ctxBuffer),this.prevDot=[...i]}draw(t,e){if(this.paint){this.ctxBuffer.clearRect(0,0,this.canvasBuffer.width,this.canvasBuffer.height),e||(e=this.ctxBuffer),this.drawPixel(...this.prevDot,e);const n=t.pageX-this.canvasBuffer.parentElement.offsetLeft,i=t.pageY-this.canvasBuffer.parentElement.offsetTop;this.currDot=this.getRightCoordinate(n,i),this.bresenhamAlgorithm(...this.prevDot,...this.currDot,e)}}bresenhamAlgorithm(t,e,n,i,r){const a=this.getRightCoordinate(t,e),s=this.getRightCoordinate(n,i);let o=a[0],c=a[1],h=a[0],l=a[1];const d=s[0],u=s[1],f=o<d?this.pixelSize:-this.pixelSize,p=c<u?this.pixelSize:-this.pixelSize;for(;;){if(o!==d)o+=f;else{if(c===u)break;c+=p}this.drawPixel(o,c,r)}for(;;){if(l!==u)l+=p;else{if(h===d)break;h+=f}this.drawPixel(h,l,r)}}stopDrawing(t){this.draw(t,this.ctx),this.paint=!1}init(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBackground.addEventListener("mousedown",this.startDrawing.bind(this)),this.canvasBackground.addEventListener("mousemove",this.draw.bind(this)),this.canvasBackground.addEventListener("mouseup",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("mouseleave",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("contextmenu",k.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/rectangle.png') 0 16, auto"}}class S{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.image=null,this.canvasBackground=document.querySelector(".canvas__background"),this.cloneCanvas=new c,this.drag=!1}static canselDefaultRightClich(t){t.preventDefault()}moveStart(t){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.image=new Image,this.image.src=this.canvas.toDataURL();const e=t.pageX-this.canvas.parentElement.offsetLeft,n=t.pageY-this.canvas.parentElement.offsetTop;this.prevDot=[e,n],this.drag=!0}move(t){if(this.drag){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);const e=t.pageX-this.canvas.parentElement.offsetLeft,n=t.pageY-this.canvas.parentElement.offsetTop;this.currDot=[e,n];const i=[this.currDot[0]-this.prevDot[0],this.currDot[1]-this.prevDot[1]];this.ctx.drawImage(this.image,...i)}}moveStop(){this.drag=!1}init(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBackground.addEventListener("mousedown",this.moveStart.bind(this)),this.canvasBackground.addEventListener("mousemove",this.move.bind(this)),this.canvasBackground.addEventListener("mouseup",this.moveStop.bind(this)),this.canvasBackground.addEventListener("contextmenu",S.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/hand.png') 8 8, auto"}}class C{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.color="rgba(130, 163, 178, 0.5)",this.pixelSize=void 0,this.paint=!1,this.selectArea=!1,this.firstPoint=[0,0],this.secondPoint=[0,0],this.rectWidthCut=void 0,this.rectHeightCut=void 0,this.prevDot=[],this.currDot=[],this.drag=!1,this.resizeTool=new _,this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.canvasWrapper=document.querySelector("#canvas__wrapper")}static canselDefaultRightClich(t){t.preventDefault()}getRightCoordinate(t,e){let n=t,i=e;return[n=Math.floor(n/this.pixelSize)*this.pixelSize,i=Math.floor(i/this.pixelSize)*this.pixelSize]}drawPixel(t,e,n){n.fillStyle=this.color,n.fillRect(t,e,this.pixelSize,this.pixelSize)}startDrawing(t){if(!this.selectArea&&!this.inArea(t)&&!this.paint){t.preventDefault(),this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.ctxBuffer.globalAlpha=.8,this.pixelSize=this.resizeTool.getCurrentPixelSize();const e=t.pageX-this.canvasBuffer.parentElement.offsetLeft,n=t.pageY-this.canvasBuffer.parentElement.offsetTop;this.paint=!0,this.firstPoint=this.getRightCoordinate(e,n),this.secondPoint=[...this.firstPoint]}}draw(t,e){if(this.paint){this.ctxBuffer.clearRect(0,0,this.canvasBuffer.width,this.canvasBuffer.height),this.selectArea=!0,e||(e=this.ctxBuffer);const n=t.pageX-this.canvasBuffer.parentElement.offsetLeft,i=t.pageY-this.canvasBuffer.parentElement.offsetTop;this.secondPoint=this.getRightCoordinate(n,i),this.secondPoint[0]>this.firstPoint[0]?this.rectWidthCut=this.secondPoint[0]-this.firstPoint[0]+this.pixelSize:this.secondPoint[0]===this.firstPoint[0]?this.rectWidthCut=this.pixelSize:this.rectWidthCut=this.secondPoint[0]-this.firstPoint[0]-this.pixelSize,this.secondPoint[1]>this.firstPoint[1]?this.rectHeightCut=this.secondPoint[1]-this.firstPoint[1]+this.pixelSize:this.secondPoint[0]===this.firstPoint[0]?this.rectHeightCut=this.pixelSize:this.rectHeightCut=this.secondPoint[1]-this.firstPoint[1]-this.pixelSize,this.ctxBuffer.fillStyle="rgba(130, 163, 178)",this.ctxBuffer.fillRect(this.firstPoint[0],this.firstPoint[1],this.rectWidthCut,this.rectHeightCut)}}cut(){this.image2=new Image,this.image2.src=this.canvas.toDataURL(),this.ctxBuffer.drawImage(this.canvas,this.firstPoint[0],this.firstPoint[1],this.rectWidthCut,this.rectHeightCut,this.firstPoint[0],this.firstPoint[1],this.rectWidthCut,this.rectHeightCut),this.selectArea&&this.ctx.clearRect(this.firstPoint[0],this.firstPoint[1],this.rectWidthCut,this.rectHeightCut)}stopDrawing(){this.paint&&(this.cut(),this.paint=!1)}moveStart(t){if(this.selectArea&&this.inArea(t)&&!this.paint){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.image=new Image,this.image.src=this.canvasBuffer.toDataURL();const e=t.pageX-this.canvasBuffer.parentElement.offsetLeft,n=t.pageY-this.canvasBuffer.parentElement.offsetTop;this.prevDot=[e,n],this.drag=!0,this.canvasWrapper.style.cursor="move"}}move(t){if(this.drag){this.ctxBuffer.clearRect(0,0,this.canvasBuffer.width,this.canvasBuffer.height);const e=t.pageX-this.canvasBuffer.parentElement.offsetLeft,n=t.pageY-this.canvasBuffer.parentElement.offsetTop;this.currDot=[e,n];const i=[this.currDot[0]-this.prevDot[0],this.currDot[1]-this.prevDot[1]];this.ctxBuffer.drawImage(this.image,...i)}}moveStop(t){if(this.drag){this.drag=!1;const e=t.pageX-this.canvasBuffer.parentElement.offsetLeft,n=t.pageY-this.canvasBuffer.parentElement.offsetTop,i=this.firstPoint[0]-this.prevDot[0],r=this.firstPoint[1]-this.prevDot[1];this.currDot=[e+i,n+r],this.ctx.drawImage(this.image2,this.firstPoint[0],this.firstPoint[1],this.rectWidthCut,this.rectHeightCut,...this.currDot,this.rectWidthCut,this.rectHeightCut),this.ctxBuffer.clearRect(0,0,this.canvasBuffer.width,this.canvasBuffer.height),this.selectArea=!1,this.firstPoint=[0,0],this.secondPoint=[0,0],this.canvasWrapper.style.cursor="crosshair"}}unSelect(t){!this.selectArea||this.inArea(t)||this.paint||(this.ctx.drawImage(this.image2,...this.firstPoint,this.rectWidthCut,this.rectHeightCut,...this.firstPoint,this.rectWidthCut,this.rectHeightCut),this.ctxBuffer.clearRect(0,0,this.canvasBuffer.width,this.canvasBuffer.height),this.image2=new Image,this.selectArea=!1,this.firstPoint=[0,0],this.secondPoint=[0,0],this.paint=!1)}inArea(t){const e=t.pageX-this.canvasBuffer.parentElement.offsetLeft,n=t.pageY-this.canvasBuffer.parentElement.offsetTop;return this.firstPoint[0]<this.secondPoint[0]&&this.firstPoint[1]<this.secondPoint[1]&&e<this.secondPoint[0]+this.pixelSize&&e>this.firstPoint[0]&&n<this.secondPoint[1]+this.pixelSize&&n>this.firstPoint[1]||(this.firstPoint[0]>this.secondPoint[0]&&this.firstPoint[1]>this.secondPoint[1]&&e<this.firstPoint[0]&&e>this.secondPoint[0]-this.pixelSize&&n<this.firstPoint[1]&&n>this.secondPoint[1]-this.pixelSize||(this.firstPoint[0]>this.secondPoint[0]&&this.firstPoint[1]<this.secondPoint[1]&&e<this.firstPoint[0]&&e>this.secondPoint[0]-this.pixelSize&&n<this.secondPoint[1]+this.pixelSize&&n>this.firstPoint[1]||this.firstPoint[0]<this.secondPoint[0]&&this.firstPoint[1]>this.secondPoint[1]&&e<this.secondPoint[0]+this.pixelSize&&e>this.firstPoint[0]&&n<this.firstPoint[1]&&n>this.secondPoint[1]-this.pixelSize))}cursorEffect(t){this.selectArea&&this.inArea(t)?this.canvasWrapper.style.cursor="move":this.drag?this.canvasWrapper.style.cursor="move":this.canvasWrapper.style.cursor="crosshair"}init(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBackground.addEventListener("mousedown",this.unSelect.bind(this)),this.canvasBackground.addEventListener("mousedown",this.startDrawing.bind(this)),this.canvasBackground.addEventListener("mousemove",this.draw.bind(this)),this.canvasBackground.addEventListener("mouseup",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("mouseleave",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("mousedown",this.moveStart.bind(this)),this.canvasBackground.addEventListener("mousemove",this.move.bind(this)),this.canvasBackground.addEventListener("mouseup",this.moveStop.bind(this)),this.canvasBackground.addEventListener("contextmenu",C.canselDefaultRightClich.bind(this)),this.canvasBackground.addEventListener("mousemove",this.cursorEffect.bind(this)),this.canvasWrapper.style.cursor="url('https://www.piskelapp.com/p/img/cursors/stroke.png') 0 16, auto"}}class A{constructor(){this.canvasBackground=document.querySelector(".canvas__background"),this.primaryColor=document.querySelector("#primary-color"),this.secondaryColor=document.querySelector("#secondary-color")}static canselDefaultRightClich(t){t.preventDefault()}static rgbToHex(t,e,n){return`#${((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1)}`}pickColor(t){const e=document.querySelector(".canvas__item").getContext("2d"),n=t.layerX,i=t.layerY,r=e.getImageData(n,i,1,1),{data:a}=r,s=A.rgbToHex(a[0],a[1],a[2]);0===t.button?this.primaryColor.value=s:2===t.button&&(this.secondaryColor.value=s)}init(){this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBackground.addEventListener("mousedown",this.pickColor.bind(this)),this.canvasBackground.addEventListener("contextmenu",A.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/dropper.png') 0 16, auto"}}class z{constructor(){this.canvas=document.querySelector(".canvas__item"),this.canvasBackground=document.querySelector(".canvas__background"),this.cloneCanvas=new c}init(){this.canvasBackground=document.querySelector(".canvas__background");const t=this.canvasBackground.cloneNode(!0);t.classList.add("canvas__background"),this.canvasBackground.parentNode.replaceChild(t,this.canvasBackground),this.canvas=document.querySelector(".canvas__item");const e=this.canvas.parentNode,n=c.clone(a[r]);n&&e.replaceChild(n,this.canvas),e.children[0].className="canvas__item"}}let B,E="pen";class T{constructor(){this.canvas=document.querySelector(".canvas__item"),this.toolsWrapper=document.querySelector(".tools__wrapper"),this.allToolsItems=document.querySelectorAll(".tools__item"),this.penTool=new b,this.bucketTool=new y,this.eraserTool=new x,this.rectangle=new k,this.move=new S,this.crop=new C,this.colorPickerCanvas=new A,this.cloneCanvasBackground=new z}static canselDefaultRightClich(t){t.preventDefault()}static cloneCanvas(t){const e=document.createElement("canvas");e.classList.add("canvas__item");const n=e.getContext("2d");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),e}deletePrevFeature(){this.canvas=document.querySelector(".canvas__item");const t=this.canvas,e=T.cloneCanvas(t);t.parentNode.replaceChild(e,t),this.canvas=e,this.cloneCanvasBackground.init(),this.canvas.addEventListener("contextmenu",T.canselDefaultRightClich.bind(this))}highlight(t){[...this.allToolsItems].map(t=>{t.classList.remove("highlight_tool")}),t.classList.add("highlight_tool")}setTool(t){switch(this.deletePrevFeature(),E){case"pen":this.penTool.init();break;case"eraser":this.eraserTool.init();break;case"rectangle":this.rectangle.init();break;case"paint-bucket":this.bucketTool.init();break;case"move":this.move.init();break;case"crop":this.crop.init();break;case"color-picker":this.colorPickerCanvas.init();break;default:this.penTool.init()}this.highlight(t)}defineTool(t){let{target:e}=t,n=null;for(;"UL"!==e.tagName;)E=e.getAttribute("data-tool"),n=e,e=e.parentElement;this.setTool(n)}static setCurrentTool(t){E=t}activePreviousTool(){const t=document.querySelector(".highlight_tool");E=t.getAttribute("data-tool"),this.setTool(t)}init(){const t=document.querySelector(".highlight_tool");this.setTool(t),this.toolsWrapper.addEventListener("click",this.defineTool.bind(this))}}const I=[!1];class R{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.frameWrapper=document.querySelector(".frames__wrapper"),this.emptyFrame=document.querySelector(".frame__background"),this.drawNewFrame=new d(this.emptyFrame),this.cloneCanvas=new c,this.emptyCanvas=c.clone(this.canvas),this.emptyDataURL=this.canvas.toDataURL(),this.setFramePrev=new m(this.emptyDataURL),this.previewTool=new p,this.checkCurrentTool=new T}delete(){I[0]=!0,this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d");const t=[...document.querySelectorAll(".frame__background")];this.frameWrapper=document.querySelector(".frames__wrapper"),this.frameWrapper.removeChild(t[r]),a.splice(r,1),r&&(B=r,s(B-=1));const e=this.canvas.parentNode;if(0!==a.length){const t=c.clone(a[r]);e.replaceChild(t,this.canvas),e.children[0].className="canvas__item",this.setFramePrev.init()}else{this.drawNewFrame.init(r+1),e.replaceChild(this.emptyCanvas,this.canvas),e.children[0].className="canvas__item",this.setFramePrev.setEmpty()}}deleteFrame(t){if(this.canvas=document.querySelector(".canvas__item"),t.target.className.indexOf("trash")>=0){a[r]=c.clone(this.canvas),s(l.check(t)),this.delete(),[...document.querySelectorAll(".frame__unit")].map((t,e)=>{t.children[1].textContent=`${e+1}`}),this.checkCurrentTool.activePreviousTool(),this.previewTool.show()}}init(){this.frameWrapper.addEventListener("mousedown",this.deleteFrame.bind(this))}}class D{constructor(){this.framesArray=[...document.querySelectorAll(".frame__unit")],this.frameWrapper=document.querySelector(".frames__wrapper")}highlightSelectedFrame(){this.framesArray=[...document.querySelectorAll(".frame__unit")],this.framesArray.forEach(t=>{t.style.borderColor="rgb(68, 68, 68)"}),this.framesArray[r].style.borderColor="rgb(255, 215, 0)"}init(){this.frameWrapper.addEventListener("mousedown",this.highlightSelectedFrame.bind(this))}}class L{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.emptyCanvas=c.clone(this.canvas),this.emptyDataURL=this.canvas.toDataURL(),this.emptyFrame=document.querySelector(".frame__background"),this.setFramePrev=new m(this.emptyDataURL),this.cloneCanvas=new c,this.drawNewFrame=new d(this.emptyFrame),this.previewTool=new p,this.checkCurrentTool=new T,this.showCurrentFrame=new D}addFrame(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),a[r]=c.clone(this.canvas),this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight),s(a.length),a.push(this.emptyCanvas),this.drawNewFrame.init(r+1),this.showCurrentFrame.highlightSelectedFrame(),this.setFramePrev.setEmpty(r),this.checkCurrentTool.activePreviousTool(),this.previewTool.show()}}class F{constructor(){this.canvas=document.querySelector(".canvas__item"),this.cloneCanvas=new c,this.prevFrame=0,this.currentFrame=0,this.emptyFrame=document.querySelector(".frame__background"),this.drawNewFrame=new d(this.emptyFrame),this.setFramePrev=new m,this.frameWrapper=document.querySelector(".frames__wrapper"),this.previewTool=new p,this.checkCurrentTool=new T}run(t){if(this.canvas=document.querySelector(".canvas__item"),t.target.className.indexOf("copy")>-1){a[r]=c.clone(this.canvas),s(l.check(t)),a.push(a[r]);const e=[...document.querySelectorAll(".frame__unit")][r].style.backgroundImage,n=this.canvas.parentElement;this.canvas=document.querySelector(".canvas__item");const i=c.clone(a[r]);n.replaceChild(i,this.canvas),n.children[0].setAttribute("class","canvas__item"),this.prevFrame=this.currentFrame,this.currentFrame+=1;const o=a.length;this.drawNewFrame.init(o),this.setFramePrev.init(null,e),s(a.length-1),this.checkCurrentTool.activePreviousTool(),this.previewTool.show()}}init(){this.frameWrapper.addEventListener("mousedown",this.run.bind(this))}}class q{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.header=document.querySelector(".header"),this.main=document.querySelector(".main"),this.framesWrapper=document.querySelector(".frames__wrapper"),this.resizeButton=document.querySelector(".resize__button"),this.resizeTimer=void 0,this.canvasBuffer=document.querySelector(".canvas__buffer")}resizeWithTimer(){clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(()=>{this.changeSize()},300)}changeSize(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background");const t=window.innerHeight,e=this.header.offsetHeight;let n=this.main.currentStyle||window.getComputedStyle(this.main),i=t-e-5*(n=n.marginTop.slice(0,-2));i=Math.round(i/v[g])*v[g];const r=document.createElement("canvas"),a=r.getContext("2d");r.width=`${i}`,r.height=`${i}`;const s=(i-this.canvas.width)/2;a.drawImage(this.canvas,s,s);const o=document.createElement("canvas"),c=o.getContext("2d");o.width=`${i}`,o.height=`${i}`;const h=(i-this.canvasBuffer.width)/2;c.drawImage(this.canvasBuffer,h,h),this.canvas.width=`${i}`,this.canvas.height=`${i}`,this.canvasBuffer.width=`${i}`,this.canvasBuffer.height=`${i}`,this.canvasBackground.style.height=`${i}px`,this.framesWrapper.style.height=`${i}px`,this.ctx.drawImage(r,0,0),this.ctxBuffer.drawImage(o,0,0)}init(){window.addEventListener("resize",this.resizeWithTimer.bind(this)),this.resizeButton.addEventListener("click",this.changeSize.bind(this))}}class U{constructor(){this.canvas=document.querySelector(".canvas__item"),this.cloneCanvas=new c,this.emptyFrame=document.querySelector(".frame__unit"),this.drawNewFrame=new d(this.emptyFrame),this.frameWrapper=document.querySelector(".frames__wrapper"),this.previewTool=new p,this.resizeOfCanvas=new q,this.checkCurrentTool=new T}selectFrame(t){const e=t.target.className,n=t.target.parentElement.className;if(e.indexOf("frame__unit")>=0||n.indexOf("frame__unit")>=0){this.canvas=document.querySelector(".canvas__item"),a[r]=c.clone(this.canvas),s(l.check(t));const e=this.canvas.parentNode,n=c.clone(a[r]);e.replaceChild(n,this.canvas),e.children[0].setAttribute("class","canvas__item"),this.resizeOfCanvas.changeSize(),this.checkCurrentTool.activePreviousTool(),this.previewTool.show()}}init(){this.frameWrapper.addEventListener("mousedown",this.selectFrame.bind(this))}}class P{constructor(){this.canvasSize=document.querySelector("#canvas_size"),this.coordinates=document.querySelector("#coordinates"),this.canvasWrapper=document.querySelector("#canvas__wrapper"),this.canvas=document.querySelector(".canvas__item"),this.canvasBackground=document.querySelector(".canvas__background"),this.ctx=this.canvas.getContext("2d"),this.resizeButton=document.querySelector(".resize__button"),this.pixelSize=19,this.resizeTool=new _,this.data=32}getRightCoordinate(t,e){let n=t,i=e;return[n=Math.floor(n/this.pixelSize)*this.pixelSize,i=Math.floor(i/this.pixelSize)*this.pixelSize]}hideCoordinates(){this.coordinates.textContent=""}showCoordinates(t){this.canvasBackground=document.querySelector(".canvas__background"),this.canvas=document.querySelector(".canvas__item");const e=t.pageX-this.canvas.parentElement.offsetLeft,n=t.pageY-this.canvas.parentElement.offsetTop;this.pixelSize=this.resizeTool.getCurrentPixelSize();const i=this.getRightCoordinate(e,n),r=i[0]/this.pixelSize,a=i[1]/this.pixelSize;r<0||r>this.data-1||a<0||a>this.data-1?this.coordinates.textContent="":this.coordinates.textContent=`${r} : ${a}`}showSize(){this.data=v[g],this.canvasSize.textContent=`[ ${this.data} x ${this.data} ]`}init(){this.resizeButton.addEventListener("click",this.showSize.bind(this)),this.canvasWrapper.addEventListener("mousemove",this.showCoordinates.bind(this)),this.canvasBackground.addEventListener("mouseleave",this.hideCoordinates.bind(this))}}class O{constructor(){this.previewItem=document.querySelector(".preview__item"),this.fullScreenButton=document.querySelector("#fullScreen")}toggleFullscreen(){this.fullScreenButton.style.display="none",this.fullScreenButton.style.width="0",document.fullscreenElement?document.exitFullscreen():this.previewItem.requestFullscreen().catch(t=>{alert(`Error attempting to enable full-screen mode: ${t.message} (${t.name})`)})}init(){this.fullScreenButton.addEventListener("click",this.toggleFullscreen.bind(this))}}class M{constructor(){this.checkCurrentTool=new T,this.allToolsItems=document.querySelectorAll(".tools__item")}static selectTool(t){switch(t.keyCode){case 80:this.getTool("pen");break;case 66:this.getTool("paint-bucket");break;case 69:this.getTool("eraser");break;case 82:this.getTool("rectangle");break;case 77:this.getTool("move");break;case 83:this.getTool("crop");break;case 79:this.getTool("color-picker")}}getTool(t){T.setCurrentTool(t),this.allToolsItems.forEach(e=>{if(e.getAttribute("data-tool")===t)return this.checkCurrentTool.setTool(e)})}init(){window.addEventListener("keydown",M.selectTool.bind(this))}}class W{constructor(){this.canvas=document.querySelector(".canvas__item"),this.frameWrapper=document.querySelector(".frames__wrapper"),this.cloneCanvas=new c,this.previewTool=new p,this.checkCurrentTool=new T,this.dragAvailable=!1,this.dragedItem=null,this.oldParentOfDragedItem=null,this.index=void 0,this.newIndex=void 0,this.bufferFrame=null}setCorrectIndexes(){if(this.newIndex!==this.index){this.canvas=document.querySelector(".canvas__item"),this.index-=1,this.newIndex-=1,a[this.index]=c.clone(this.canvas);const t=this.canvas.parentNode,e=c.clone(a[r]);t.replaceChild(e,this.canvas),this.bufferFrame=a[this.index],a[this.index]=a[this.newIndex],a[this.newIndex]=this.bufferFrame,s(this.newIndex);const n=document.querySelectorAll(".frame__unit");for(let t=0;t<n.length;t+=1)n[t].children[1].textContent=`${t+1}`;this.checkCurrentTool.activePreviousTool(),this.previewTool.show(),this.newIndex=void 0}}pickUpItem(t){let{target:e}=t;for(;e.className.indexOf("frames__wrapper")<0;){if(e.className.indexOf("frame__unit")>=0)return this.dragAvailable=!0,this.dragedItem=e,this.oldParentOfDragedItem=this.dragedItem.parentElement,void(this.startSpot=t.pageY);e=e.parentElement}}moveItem(t){if(this.dragAvailable){const e=t.pageY-this.dragedItem.offsetHeight/2;this.dragedItem.style.zIndex=100,this.dragedItem.style.position="absolute",this.dragedItem.style.top=`${e}px`}}dropItem(t){if(this.dragAvailable){if(this.dragAvailable=!1,I[0])return void(I[0]=!1);this.index=this.dragedItem.children[1].textContent;const e=t.pageY,n=this.oldParentOfDragedItem.offsetTop,i=this.oldParentOfDragedItem.offsetHeight;if(e>=n&&e<=i)return this.dragedItem.style.position="relative",this.dragedItem.style.zIndex="auto",this.dragedItem.style.top="auto",this.dragedItem.style.left="auto",void(this.newIndex=void 0);const r=document.querySelectorAll(".frame__unit");for(let n=0;n<r.length;n+=1){const i=r[n].parentElement,a=i.offsetTop,s=i.offsetHeight;if(e>=a&&e<=a+s)return t.target.style.position="relative",t.target.style.zIndex="auto",t.target.style.top="auto",t.target.style.left="auto",i.insertBefore(this.dragedItem,r[n]),this.oldParentOfDragedItem.appendChild(r[n]),this.newIndex=r[n].children[1].textContent,void this.setCorrectIndexes()}this.dragedItem.style.position="relative",this.dragedItem.style.zIndex="auto",this.dragedItem.style.top="auto",this.dragedItem.style.left="auto",this.newIndex=void 0}}init(){this.frameWrapper.addEventListener("mousedown",this.pickUpItem.bind(this)),document.body.addEventListener("mousemove",this.moveItem.bind(this)),document.body.addEventListener("mouseup",this.dropItem.bind(this))}}const N=n(10);class H{constructor(){this.size=void 0,this.downloadButton=document.querySelector(".apng__download")}getAllSprites(){const t=[];return a.forEach(e=>{const n=e.getContext("2d").getImageData(0,0,e.width,e.height).data;this.size=e.width,t.push(n)}),t}makeAPNG(){const t=this.getAllSprites(),e=new Array(t.length);e.fill(200);const n=N.encode([...t],this.size,this.size,0,[...e]),i=new Uint8Array(n),r=btoa(String.fromCharCode.apply(null,i));this.downloadButton.href=`data:image/png;base64,${r}`}init(){this.downloadButton.addEventListener("mousedown",this.makeAPNG.bind(this))}}var j=n(9),Z=n.n(j);class V{constructor(){this.size=void 0,this.gifDownloadButton=document.querySelector(".gif__download")}getAllSprites(){const t=[];return a.forEach(e=>{const n=e.toDataURL();this.size=e.width,t.push(n)}),t}makeGIF(){const t=this.getAllSprites();if(this.gifDownloadButton.getAttribute("data-download")){const t=document.querySelector(".gif__download");t.removeAttribute("data-download"),setTimeout(()=>{t.removeAttribute("download")},200)}else Z.a.createGIF({images:[...t],gifWidth:this.size,gifHeight:this.size,interval:.2},function(t){if(!t.error){const{image:e}=t,n=document.querySelector(".gif__download");n.href=e,n.setAttribute("download","animated-image-gif"),n.setAttribute("data-download","loadFile")}}),setTimeout(()=>{document.querySelector(".gif__download").click()},1e3)}init(){this.gifDownloadButton.addEventListener("click",this.makeGIF.bind(this))}}class G{constructor(){this.canvas=document.querySelector(".canvas__item"),this.emptyDataURL=this.canvas.toDataURL(),this.setFramePrev=new m(this.emptyDataURL),this.addNewFrame=new L,this.canvasData=new P,this.addFrameButton=document.querySelector(".frames__add-frame-button"),this.canvasWrapper=document.querySelector("#canvas__wrapper"),this.shortcuts=new M,this.dragAndDrop=new W,this.aPNG=new H,this.gifMaker=new V}init(){this.canvasWrapper.addEventListener("contextmenu",this.canselDefaultRightClich),(new T).init(),(new i).init(),(new o).init(),(new R).init(),(new F).init(),this.dragAndDrop.init(),(new p).init(),(new _).init();const t=new q;t.init(),t.changeSize(),(new O).init(),this.canvasWrapper.addEventListener("click",this.setFramePrev.init.bind(this)),this.canvasWrapper.addEventListener("contextmenu",this.setFramePrev.init.bind(this)),this.addFrameButton.addEventListener("click",this.addNewFrame.addFrame.bind(this.addNewFrame)),(new U).init(),this.firstFrame=document.querySelector(".frame__unit"),this.firstFrame.style.borderColor="rgb(255, 215, 0)",(new D).init(),this.canvasData.init(),this.shortcuts.init(),this.aPNG.init(),this.gifMaker.init()}}n(21),n(24),n(26);document.addEventListener("DOMContentLoaded",()=>{(new G).init()},!1)}]);
//# sourceMappingURL=app.bundle.js.map